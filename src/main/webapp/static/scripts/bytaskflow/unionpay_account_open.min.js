webpackJsonp([122],{"3eH2":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),i=a.n(n),o=a("7+uW"),s=a("mvHQ"),r=a.n(s),c=a("mtWM"),l=a.n(c),p=a("oAV5");window.task_flow_version="beiyi_flow";var u={data:function(){return{assignee:pageDataObject.assignee,flowStartDate:p.b.formatDate(new Date(pageDataObject.flowStartDate),"yyyy-MM-dd hh:mm:ss"),flowEndDate:p.b.formatDate(new Date(pageDataObject.flowEndDate),"yyyy-MM-dd hh:mm:ss"),staticText:{title:"进件资料收集",subtitle:["订单信息","本次服务类型","订单负责人员","商户联系人","掌贝后台进行机具号配置","商户联系人","任务操作","*基于商户原因，不开通银联支付","任务操作指引","任务操作备忘","不开通银联支付"],subtitlebtn:"订单详情",contentwrap:{label:["订单号：","购买时间：","商户名称：","商户简称：","联系人：","联系电话：","销售人：","销售人联系方式："],typelabel:["服务项：","服务类型：","商户类型："],clabel:["运营顾问：","开户顾问：","物料顾问：","确认商户是否已经微信公众号（必须为服务号）：","确认商户是否已有口碑门店（支付宝）：","小程序账号：","默认密码："],remarklabel:["完成在掌贝后台进行机具号配置","电话沟通联系运营负责人（老板），询问老板微信号","添加商户运营负责人微信","银联支付进件状态为通过，后点击获取机具号，在掌贝后台进行机具号配置"],remark:deliveryFlowStaticContent.unionpay_account_open}},tip:{a:!1,b:!1,c:!1},taskId:erpApp.getQueryString("taskId"),procInsId:erpApp.getQueryString("procInsId"),unionpayInfo:{orderId:"",machineToolNumber:"",unionpayRemark:"",unionpayState:0,shopInfoId:""},unionpayState:["未提交","新增待审核","通过","拒绝","已下架","更新待审核","待审核","正在审核"],unionpayOpenState:"Y",machineNoConfiguration:"",notOpenUnionpayScreenshot:""}},computed:{info:function(){return this.unionpayInfo},auditLink:function(){return ctx+"/store/basic/erpStoreInfo/payOpen/?id="+this.info.shopInfoId+"&type=unionpay"},infoLink:function(){return ctx+"/store/basic/erpStoreInfo/urlErpShopInfoList?id="+this.info.shopInfoId}},mounted:function(){this.getFlowUnionpayInfo()},methods:{clickHandler:function(){var t=this;if("N"!==this.unionpayOpenState||this.notOpenUnionpayScreenshot)if("Y"!==this.unionpayOpenState||this.machineNoConfiguration){var e="N"===this.unionpayOpenState?"确定不开通银联支付吗？":"确定要开通银联支付吗？";erpApp.confirm(e,function(){l()({method:"post",url:ctx+"/delivery/flow/unionpay_account_open",data:{taskId:t.taskId,procInsId:t.procInsId,orderId:t.info.orderId,machineNoConfiguration:t.machineNoConfiguration,unionpayOpenState:t.unionpayOpenState,notOpenUnionpayScreenshot:t.notOpenUnionpayScreenshot},transformRequest:[function(t){var e="";for(var a in t)"object"===erpApp.util.type(t[a])?e+=encodeURIComponent(a)+"="+r()(t[a])+"&":e+=encodeURIComponent(a)+"="+t[a]+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){t.data.result?(erpApp.tip(t.data.message||"处理成功！"),erpApp.jumpToTasklistPage("beiyiTaskFlow")):erpApp.tip(t.data.message||"处理失败！")})})}else erpApp.tip("请确认完成在掌贝后台进行机具号配置！");else erpApp.tip("请上传商户确认不进行银联支付的聊天截图！")},getFlowUnionpayInfo:function(){var t=this;l.a.get(ctx+"/delivery/flow/getFlowUnionpayInfo",{params:{taskId:this.taskId,procInsId:this.procInsId}}).then(function(e){e.data.result&&(t.unionpayInfo=erpApp.extend(!0,t.unionpayInfo,e.data))})},toggleMore:function(t){this.tip[t]=!this.tip[t]},undisableOpen:function(){var t=this;erpApp.openPayDialog(this.procInsId,"确定商户不进行银联支付开通","unionpay",function(e){t.notOpenUnionpayScreenshot=e.trim().replace(/,/g,";"),t.unionpayOpenState="N",t.clickHandler()},this.taskId)}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"taskflow-content"},[a("div",{staticClass:"task-detail-wrapper",attrs:{id:"taskDetailWrapper"}},[a("h3",{staticClass:"task-title"},[t._v("银联支付开通 — （"+t._s(t.unionpayState[t.info.unionpayState])+"）")]),t._v(" "),a("div",{staticClass:"task-sider"},[a("h3",{staticClass:"task-sider-title"},[t._v("完善银联进件资料并提审")]),t._v(" "),a("div",{staticClass:"task-sider-subtitle"},[a("span",[t._v(t._s(t.staticText.subtitle[9]))])]),t._v(" "),a("div",{staticClass:"task-sider-content"},[a("div",{staticClass:"content-wrap"},[a("div",{staticClass:"hsck",staticStyle:{border:"none"}},[a("div",{domProps:{innerHTML:t._s(t.staticText.contentwrap.remark.remark)}})])])]),t._v(" "),a("div",{staticClass:"task-sider-subtitle"},[a("span",[t._v(t._s(t.staticText.subtitle[8]))]),t._v(" "),a("a",{staticClass:"disblock floatright togglemoreinfo",class:{show:t.tip.c},attrs:{href:"javascript:;"},on:{click:function(e){t.toggleMore("c")}}},[a("i",{staticClass:"icon-chevron-down icon"})])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tip.c,expression:"tip.c"}],staticClass:"task-sider-content"},[a("div",{staticClass:"content-wrap"},[a("div",{staticClass:"hsck"},[a("div",[t._v(t._s(t.staticText.contentwrap.remark.czzyone))])])])]),t._v(" "),a("div",{staticClass:"task-sider-subtitlec"},[a("i",{staticClass:"icon-wrench"}),a("span",[t._v(t._s(t.staticText.subtitle[6]))])]),t._v(" "),a("div",{staticClass:"task-sider-content"},[a("div",{staticClass:"content-wrap"},[a("div",{staticClass:"border-bottom"},[a("p",[t._v("银联支付进件状态："+t._s(t.unionpayState[t.info.unionpayState]))]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:3===t.info.unionpayState,expression:"info.unionpayState === 3"}],staticClass:"hsck margin-bottom-10"},[t._v(t._s(t.info.unionpayRemark))])]),t._v(" "),a("div",{staticClass:"sub-info"},[t._v("\n\t\t\t\t\t\t"+t._s(t.staticText.contentwrap.remark.text[0])+"\n\t\t\t\t\t")]),t._v(" "),a("div",[a("a",{staticClass:"btn btn-primary",attrs:{href:t.infoLink,target:"_blanlk"}},[t._v("录入银联支付进件资料")])]),t._v(" "),a("div",{staticClass:"sub-info"},[t._v(t._s(t.staticText.contentwrap.remark.text[1]))]),t._v(" "),a("div",[a("a",{staticClass:"btn btn-primary",attrs:{href:t.auditLink,target:"_blanlk"}},[t._v("银联支付进件提审")])])])])]),t._v(" "),a("div",{staticClass:"task-sider"},[a("div",{staticClass:"task-sider-title"},[a("span",[t._v(t._s(t.staticText.subtitle[4]))])]),t._v(" "),a("div",{staticClass:"task-sider-subtitle"},[a("span",[t._v(t._s(t.staticText.subtitle[8]))]),t._v(" "),a("a",{staticClass:"disblock floatright togglemoreinfo",class:{show:t.tip.a},attrs:{href:"javascript:;"},on:{click:function(e){t.toggleMore("a")}}},[a("i",{staticClass:"icon-chevron-down icon"})])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tip.a,expression:"tip.a"}],staticClass:"task-sider-content"},[a("div",{staticClass:"content-wrap"},[a("div",{staticClass:"hsck"},[a("div",{domProps:{innerHTML:t._s(t.staticText.contentwrap.remark.czzytow)}})])])]),t._v(" "),a("div",{staticClass:"task-sider-subtitlec"},[a("i",{staticClass:"icon-wrench"}),a("span",[t._v(t._s(t.staticText.subtitle[6]))])]),t._v(" "),a("div",{staticClass:"task-sider-content"},[a("div",{staticClass:"content-wrap"},[a("div",{directives:[{name:"show",rawName:"v-show",value:2===t.info.unionpayState,expression:"info.unionpayState === 2"}]},[a("p",{staticClass:"sub-info-p"},[t._v(t._s(t.staticText.contentwrap.remarklabel[3]))]),t._v(" "),a("div",{staticClass:"hsck margin-bottom-10"},[a("div",[t._v(t._s(t.info.machineToolNumber))])])]),t._v(" "),a("div",{staticClass:"checkbox-list"},[a("label",{staticClass:"content-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.machineNoConfiguration,expression:"machineNoConfiguration"}],attrs:{type:"checkbox",value:"Y"},domProps:{checked:Array.isArray(t.machineNoConfiguration)?t._i(t.machineNoConfiguration,"Y")>-1:t.machineNoConfiguration},on:{change:function(e){var a=t.machineNoConfiguration,n=e.target,i=!!n.checked;if(Array.isArray(a)){var o=t._i(a,"Y");n.checked?o<0&&(t.machineNoConfiguration=a.concat(["Y"])):o>-1&&(t.machineNoConfiguration=a.slice(0,o).concat(a.slice(o+1)))}else t.machineNoConfiguration=i}}}),t._v(t._s(t.staticText.contentwrap.remarklabel[0])+"\n\t\t\t\t\t\t")])])])])]),t._v(" "),a("div",{staticClass:"task-sider"},[a("div",{staticClass:"task-sider-title"},[t._v(t._s(t.staticText.subtitle[10]))]),t._v(" "),a("div",{staticClass:"task-sider-subtitle"},[a("span",[t._v(t._s(t.staticText.subtitle[7]))])]),t._v(" "),a("div",{staticClass:"content-wrap"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.undisableOpen}},[t._v("不开通银联支付")])])]),t._v(" "),a("div",{staticClass:"task-detail-footer"},[a("div",{staticClass:"footer-info"},[a("p",[t._v("负责人："+t._s(t.assignee))]),t._v(" "),a("p",[t._v(t._s(t.flowStartDate)+" —— "+t._s(t.flowEndDate))])]),t._v(" "),a("div",{staticClass:"footer-btn"},[a("button",{staticClass:"btn btn-primary btn-large",attrs:{type:"button"},on:{click:t.clickHandler}},[t._v("确定完成")])])])])])},staticRenderFns:[]},f=a("VU/8")(u,d,!1,null,null,null).exports;o.default.config.productionTip=!1,o.default.config.devtools=!1,new o.default(i()({},f)).$mount("#rootNode")},oAV5:function(t,e,a){"use strict";a.d(e,"f",function(){return l}),a.d(e,"g",function(){return p}),a.d(e,"e",function(){return u}),a.d(e,"d",function(){return d}),a.d(e,"b",function(){return h}),a.d(e,"a",function(){return y});var n=a("//Fk"),i=a.n(n),o=a("mvHQ"),s=a.n(o),r=a("pFYg"),c=a.n(r),l=function(t,e,a){for(var n=0,i=e.length,o=!1;n<i;){if(t===e[n][a]){o=!0;break}n++}return o},p=function(t){return""+t.replace(/(^\s*)|(\s*$)/g,"")},u=function(){var t=new Date,e=t.getMonth()+1,a=t.getDate();return t.getFullYear()+"-"+(e>9?e:"0"+e)+"-"+(a>9?a:"0"+a)};f.prototype.getDateStr3=function(t){var e=t;return""+e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):""+(e.getMonth()+1))+"-"+(e.getDate()<10?"0"+e.getDate():""+e.getDate())},f.prototype.getWeekStartAndEnd=function(t){var e=new Date,a=(e=new Date(e.getTime()+6048e5*t)).getDay(),n=(e.getDate(),0!=a?a-1:6),i=new Date(e.getTime()-864e5*n),o=new Date(i.getTime()+5184e5);return this.getDateStr3(i)+" - "+this.getDateStr3(o)};var d=function(t,e,a){t=t;var n=e?new Date(e):new Date,i=n.getFullYear(),o=n.getMonth()+1,s=n.getDate();return s<=t&&(o>1?o-=1:(i-=1,o=12)),"before"===a?n.setDate(n.getDate()-t):n.setDate(n.getDate()+t),i=n.getFullYear(),o=n.getMonth()+1,s=n.getDate(),i+"-"+(o<10?"0"+o:o)+"-"+(s<10?"0"+s:s)};function f(t){this.date=t.date,this.type=t.type,this.value=void 0!==t.value?t.value:0,this.format=void 0!==t.format?t.format:"yyyy/MM/dd",this.date instanceof Date?(this.year=this.date.getFullYear(),this.month=this.date.getMonth()+1,this.day=this.date.getDate()):(this.year=this.date.substr(0,4),this.month=this.date.substr(5,2),this.day=this.date.substr(8,2))}f.prototype.beforeDate=function(t,e){var a=t||this.type,n=e||this.value,i=this.year,o=this.month,s=this.day;"year"===a||"年"===a?i-=n:"month"===a||"月"===a?(i-=parseInt(n/12),(o-=n%12)<=0&&(i-=1,o+=12)):"day"!==a&&"日"!==a||(s-=n%30)<=0&&(i-=1,o+=12);var r=new Date(i,o-1,s);return this.formatDate(r,this.format)},f.prototype.formatDate=function(t,e){var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e},f.prototype.getThisMonth=function(){var t=new Date(this.year,this.month-1),e=new Date(this.year,this.month,0);return this.formatDate(t,this.format)+" - "+this.formatDate(e,this.format)},f.prototype.getSomeMonth=function(t){return this.beforeDate("month",t)+" - "+this.beforeDate("now",0)},f.prototype.getThisYear=function(){var t=new Date(this.year,0,1),e=new Date(this.year,11,31);return this.formatDate(t,this.format)+" - "+this.formatDate(e,this.format)},f.prototype.formatTimeStr=function(t){var e=new Date,a=parseInt(e.getTime()),n=new Date(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+(e.getDate()-1)+" 00:00:01"),i=new Date(t),o=(a-t)/1e3;return o>=31536e3||i.getFullYear()!=e.getFullYear()?i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate():o>259200?i.getMonth()+1+"-"+i.getDate():i.getDate()==n.getDate()?"昨天":o>86400?Math.ceil(o/86400)+"天前":o>3600?Math.floor(o/3600)+"小时前":o>60?Math.floor(o/60)+"分钟前":"刚刚"};var h=new f({date:"2018-06-01",type:"month",value:"14",format:"yyyy-MM-dd hh:mm:ss"}),v=function(t){var e,a,n,i={url:location.href,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,xhr:function(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){return new ActiveXObject("Microsoft.XMLHTTP")}}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript, application/x-javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},o={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},s=(new Date).getTime(),r=/\[\]$/,l=/\=\?(&|$)/,p=/\?/,u=/%20/g,d=/\S/,f={},h={},v=function t(){var e,a,n,i,o,s,r=arguments[0]||{},l=arguments.length;for(e=1;e<l;++e)if(null!=(a=arguments[e]))for(s in a)n=r[s],i=a[s],r!==i&&("object"===(void 0===i?"undefined":c()(i))?(o=n&&"object"===(void 0===n?"undefined":c()(n))?n:{},r[s]=t(o,i)):void 0!==i&&(r[s]=i));return r}(i,t),y=v.type.toUpperCase(),m=/^(?:GET|HEAD)$/.test(y);if(v.url=v.url.replace(/#.*$/,""),v.context=t&&null!=t.context?t.context:v,v.data&&v.processData&&"string"!=typeof v.data&&(v.data=function(t){var e,a=[],n=function(t,e){e=M(e)?e():e,a[a.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(j(t))for(e in t)n(e,t[e]);else for(var i in t)N(i,t[i],n);return a.join("&").replace(u,"+")}(v.data)),"jsonp"===v.dataType&&("GET"===y?l.test(v.url)||(v.url+=(p.test(v.url)?"&":"?")+(v.jsonp||"callback")+"=?"):v.data&&l.test(v.data)||(v.data=(v.data?v.data+"&":"")+(v.jsonp||"callback")+"=?"),v.dataType="json"),"json"===v.dataType&&(v.data&&l.test(v.data)||l.test(v.url))){e=v.jsonpCallback||"jsonp"+s++,v.data&&(v.data=(v.data+"").replace(l,"="+e+"$1")),v.url=v.url.replace(l,"="+e+"$1"),v.dataType="script";var g=window[e];window[e]=function(t){if(M(g))g(t);else{window[e]=void 0;try{delete window[e]}catch(t){}}O(v,T,a,n=t),R(v,T,a),C&&C.removeChild(_)}}v.data&&m&&(v.url+=(p.test(v.url)?"&":"?")+v.data);var b=/^(\w+:)?\/\/([^\/?#]+)/.exec(v.url),w=b&&(b[1]&&b[1].toLowerCase()!==location.protocol||b[2].toLowerCase()!==location.host);if("script"===v.dataType&&"GET"===y&&w){var C=document.getElementsByTagName("head")[0]||document.documentElement,_=document.createElement("script");if(v.scriptCharset&&(_.charset=v.scriptCharset),_.src=v.url,!e){var k=!1;_.onload=_.onreadystatechange=function(){k||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(k=!0,O(v,T,a,n),R(v,T,a),_.onload=_.onreadystatechange=null,C&&_.parentNode&&C.removeChild(_))}}C.insertBefore(_,C.firstChild)}else{var x=!1,T=v.xhr();if(T){v.username?T.open(y,v.url,v.async,v.username,v.password):T.open(y,v.url,v.async),v.withCredentials&&"withCredentials"in T&&(T.withCredentials=!0);try{(null!=v.data&&!m||t&&t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),v.ifModified&&(f[v.url]&&T.setRequestHeader("If-Modified-Since",f[v.url]),h[v.url]&&T.setRequestHeader("If-None-Match",h[v.url])),w||T.setRequestHeader("X-Requested-With","XMLHttpRequest"),T.setRequestHeader("Accept",v.dataType&&v.accepts[v.dataType]?v.accepts[v.dataType]+", */*; q=0.01":v.accepts._default)}catch(t){}if(v.beforeSend&&!1===v.beforeSend.call(v.context,T,v))return T.abort(),!1;var D=T.onreadystatechange=function(t){if(T&&0!==T.readyState&&"abort"!==t){if(!x&&T&&(4===T.readyState||"timeout"===t)){var i;if(x=!0,T.onreadystatechange=F,"success"===(a="timeout"===t?"timeout":function(t){try{return!t.status&&"file:"===location.protocol||t.status>=200&&t.status<300||304===t.status||1223===t.status}catch(t){}return!1}(T)?v.ifModified&&function(t,e){var a=t.getResponseHeader("Last-Modified"),n=t.getResponseHeader("Etag");a&&(a[e]=a);n&&(n[e]=n);return 304===t.status}(T,v.url)?"notmodified":"success":"error"))try{n=function(t,e,a){var n=t.getResponseHeader("content-type")||"",i="xml"===e||!e&&n.indexOf("xml")>=0,o=i?t.responseXML:t.responseText;if(i&&"parsererror"===o.documentElement.nodeName)throw"parsererror";a&&a.dataFilter&&(o=a.dataFilter(o,e));"string"==typeof o&&("json"===e||!e&&n.indexOf("json")>=0?o=JSON.parse(o):("script"===e||!e&&n.indexOf("javascript")>=0)&&function(t){if(t&&d.test(t)){var e=document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("script");a.type="text/javascript",scriptEval?a.appendChild(document.createTextNode(t)):a.text=t,e.insertBefore(a,e.firstChild),e.removeChild(a)}}(o));return o}(T,v.dataType,v)}catch(t){a="parsererror",i=t}"success"===a||"notmodified"===a?e||O(v,T,a,n):E(v,T,a,i),e||R(v,T,a),"timeout"===t&&T.abort(),v.async&&(T=null)}}else x||R(v,T,a),x=!0,T&&(T.onreadystatechange=F)};try{var S=T.abort;T.abort=function(){T&&Function.prototype.call.call(S,T),D("abort")}}catch(t){}v.async&&v.timeout>0&&setTimeout(function(){T&&!x&&D("timeout")},v.timeout);try{T.send(m||null==v.data?null:v.data)}catch(t){E(v,T,null,t),R(v,T,a)}return v.async||D(),T}}function I(t){return null==t?String(t):o[toString.call(t)]||"object"}function M(t){return"function"===I(t)}function j(t){return"array"===I(t)}function N(t,e,a){if(j(e)&&e.length)for(var n in e){var i=e[n];r.test(t)?a(t,i):N(t+"["+("object"===(void 0===i?"undefined":c()(i))||j(i)?n:"")+"]",i,a)}else if(null!=e&&"object"===(void 0===e?"undefined":c()(e)))if(function(t){for(var e in t)return!1;return!0}(e))a(t,"");else for(var o in e){N(t+"["+o+"]",i=e[o],a)}else a(t,e)}function E(t,e,a,n){"function"==typeof t.error&&t.error.call(t.context,e,a,n)}function O(t,e,a,n){"function"==typeof t.success&&t.success.call(t.context,n,a,e)}function R(t,e,a){"function"==typeof t.complete&&t.complete.call(t.context,e,a)}function F(){}},y=function(t){var e,a,n=t.data;return"string"==typeof t.dataType&&"string"==typeof t.type&&"json"===(e=t.dataType.toLowerCase())&&"post"===t.type.toLowerCase()&&(n=s()(t.data)),"string"==typeof t.contentType&&(a=t.contentType.toLowerCase()),new i.a(function(i,o){v({url:t.url||"url",type:t.type||"GET",async:!1!==t.async,withCredentials:t.withCredentials,data:n,dataType:e||"default",contentType:a||"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:function(){return"function"!=typeof t.beforeSend||t.beforeSend()},success:function(t,e,a,n){i(t,e,a,n)},error:function(t,e,a,n){o({responseText:t.responseText,code:t.status})},complete:function(t,e,a){i(t,e,a)}})})};e.c=f}},["3eH2"]);