webpackJsonp([91],{BD2p:function(t,e,a){"use strict";var n=a("bOdI"),r=a.n(n),i={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return"ivu-icon ivu-icon-"+this.type},styles:function(){var t={};return this.size&&(t["font-size"]=this.size+"px"),this.color&&(t.color=this.color),t}}},s={render:function(){var t=this.$createElement;return(this._self._c||t)("i",{class:this.classes,style:this.styles})},staticRenderFns:[]},o=a("VU/8")(i,s,!1,null,null,null).exports,c=(a("BO1k"),a("7+uW").default.prototype.$isServer);function l(t,e){for(var a=0;a<e.length;a++)if(t===e[a])return!0;return!1}!c&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver);var u={components:{Icon:o},props:{percent:{type:Number,default:0},status:{validator:function(t){return l(t,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1}},data:function(){return{currentStatus:this.status}},computed:{isStatus:function(){return"wrong"==this.currentStatus||"success"==this.currentStatus},statusIcon:function(){var t="";switch(this.currentStatus){case"wrong":t="ios-close";break;case"success":t="ios-checkmark"}return t},bgStyle:function(){return this.vertical?{height:this.percent+"%",width:this.strokeWidth+"px"}:{width:this.percent+"%",height:this.strokeWidth+"px"}},wrapClasses:function(){var t;return["ivu-progress","ivu-progress-"+this.currentStatus,(t={},r()(t,"ivu-progress-show-info",!this.hideInfo),r()(t,"ivu-progress-vertical",this.vertical),t)]},textClasses:function(){return"ivu-progress-text"},textInnerClasses:function(){return"ivu-progress-text-inner"},outerClasses:function(){return"ivu-progress-outer"},innerClasses:function(){return"ivu-progress-inner"},bgClasses:function(){return"ivu-progress-bg"}},created:function(){this.handleStatus()},methods:{handleStatus:function(t){t?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100==parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent:function(t,e){t<e?this.handleStatus(!0):this.handleStatus()},status:function(t){this.currentStatus=t}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.wrapClasses},[a("div",{class:t.outerClasses},[a("div",{class:t.innerClasses},[a("div",{class:t.bgClasses,style:t.bgStyle})])]),t._v(" "),t.hideInfo?t._e():a("span",{class:t.textClasses},[t._t("default",[t.isStatus?a("span",{class:t.textInnerClasses},[a("Icon",{attrs:{type:t.statusIcon}})],1):a("span",{class:t.textInnerClasses},[t._v("\n                "+t._s(t.percent)+"%\n            ")])])],2)])},staticRenderFns:[]},p={name:"UploadList",components:{Icon:o,iProgress:a("VU/8")(u,d,!1,null,null,null).exports},props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(t){return["ivu-upload-list-file",r()({},"ivu-upload-list-file-finish","finished"===t.status)]},handleClick:function(t){this.$emit("on-file-click",t)},handlePreview:function(t){this.$emit("on-file-preview",t)},handleRemove:function(t){this.$emit("on-file-remove",t)},format:function(t){var e=t.name.split(".").pop().toLocaleLowerCase()||"",a="document";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(e)>-1&&(a="image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(e)>-1&&(a="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(e)>-1&&(a="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(e)>-1&&(a="document-text"),["numbers","csv","xls","xlsx"].indexOf(e)>-1&&(a="stats-bars"),["keynote","ppt","pptx"].indexOf(e)>-1&&(a="ios-videocam"),a},parsePercentage:function(t){return parseInt(t,10)}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{class:[t.prefixCls+"-list"]},t._l(t.files,function(e){return a("li",{class:t.fileCls(e),on:{click:function(a){t.handleClick(e)}}},[a("span",{on:{click:function(a){t.handlePreview(e)}}},[a("Icon",{attrs:{type:t.format(e)}}),t._v(" "+t._s(e.name)+"\n        ")],1),t._v(" "),a("Icon",{directives:[{name:"show",rawName:"v-show",value:"finished"===e.status,expression:"file.status === 'finished'"}],class:[t.prefixCls+"-list-remove"],attrs:{type:"ios-close-empty"},nativeOn:{click:function(a){t.handleRemove(e)}}}),t._v(" "),a("transition",{attrs:{name:"fade"}},[e.showProgress?a("i-progress",{attrs:{"stroke-width":2,percent:t.parsePercentage(e.percentage),status:"finished"===e.status&&e.showProgress?"success":"normal"}}):t._e()],1)],1)}))},staticRenderFns:[]},h=a("VU/8")(p,f,!1,null,null,null).exports,m=a("fZjL"),v=a.n(m);function g(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function y(t){if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest,a=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var n=new FormData;t.data&&v()(t.data).map(function(e){n.append(e,t.data[e])}),n.append(t.filename,t.file),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,a){var n="fail to post "+t+" "+a.status+"'",r=new Error(n);return r.status=a.status,r.method="post",r.url=t,r}(a,0,e),g(e));t.onSuccess(g(e))},e.open("post",a,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var r=t.headers||{};for(var i in r)r.hasOwnProperty(i)&&null!==r[i]&&e.setRequestHeader(i,r[i]);e.send(n)}}var w={name:"Upload",mixins:[{methods:{dispatch:function(t,e,a){for(var n=this.$parent||this.$root,r=n.$options.name;n&&(!r||r!==t);)(n=n.$parent)&&(r=n.$options.name);n&&n.$emit.apply(n,[e].concat(a))},broadcast:function(t,e,a){(function t(e,a,n){this.$children.forEach(function(r){r.$options.name===e?r.$emit.apply(r,[a].concat(n)):t.apply(r,[e,a].concat([n]))})}).call(this,t,e,a)}}}],components:{UploadList:h},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(t){return l(t,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},maxSelectNum:{type:Number},existNum:{type:Number},index:{type:Number}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var t;return["ivu-upload",(t={},r()(t,"ivu-upload-select","select"===this.type),r()(t,"ivu-upload-drag","drag"===this.type),r()(t,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),t)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(t){var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},onDrop:function(t){this.dragOver=!1,this.uploadFiles(t.dataTransfer.files)},uploadFiles:function(t){var e=this,a=Array.prototype.slice.call(t);if(this.maxSelectNum&&a.length>this.maxSelectNum-this.existNum)return erpShopApp.tip("最多只能上传"+this.maxSelectNum+"张图片！","info"),!1;this.multiple||(a=a.slice(0,1)),0!==a.length&&a.forEach(function(t){e.upload(t)})},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);var a=this.beforeUpload(t,this.index);a&&a.then?a.then(function(a){"[object File]"===Object.prototype.toString.call(a)?e.post(a):e.post(t)},function(){}):!1!==a&&this.post(t)},post:function(t){var e=this;if(this.format.length){var a=t.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(t){return t.toLocaleLowerCase()===a}))return this.onFormatError(t,this.fileList),!1}if(this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),(new FormData).append(this.name,t),y({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(a){e.handleProgress(a,t)},onSuccess:function(a){e.handleSuccess(a,t,e.index)},onError:function(a,n){e.handleError(a,n,t)}})},handleStart:function(t){t.uid=Date.now()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e)},getFile:function(t){var e=void 0;return this.fileList.every(function(a){return!(e=t.uid===a.uid?a:null)}),e},handleProgress:function(t,e){var a=this.getFile(e);this.onProgress(t,a,this.fileList),a.percentage=t.percent||0},handleSuccess:function(t,e,a){var n=this.getFile(e);n&&(n.status="finished",n.response=t,this.dispatch("FormItem","on-form-change",n),this.onSuccess(t,n,this.fileList,a),setTimeout(function(){n.showProgress=!1},1e3))},handleError:function(t,e,a){var n=this.getFile(a),r=this.fileList;n.status="fail",r.splice(r.indexOf(n),1),this.onError(t,e,a)},handleRemove:function(t){var e=this.fileList;e.splice(e.indexOf(t),1),this.onRemove(t,e)},handlePreview:function(t){"finished"===t.status&&this.onPreview(t)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(t){var e=this;this.fileList=t.map(function(t){return t.status="finished",t.percentage=100,t.uid=Date.now()+e.tempIndex++,t})}}}},x={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:[t.prefixCls]},[a("div",{class:t.classes,on:{click:t.handleClick,drop:function(e){e.preventDefault(),t.onDrop(e)},dragover:function(e){e.preventDefault(),t.dragOver=!0},dragleave:function(e){e.preventDefault(),t.dragOver=!1}}},[a("input",{ref:"input",class:[t.prefixCls+"-input"],attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}}),t._v(" "),t._t("default")],2),t._v(" "),t._t("tip"),t._v(" "),t.showUploadList?a("upload-list",{attrs:{files:t.fileList},on:{"on-file-remove":t.handleRemove,"on-file-preview":t.handlePreview}}):t._e()],2)},staticRenderFns:[]},b=a("VU/8")(w,x,!1,null,null,null);e.a=b.exports},oAV5:function(t,e,a){"use strict";a.d(e,"f",function(){return l}),a.d(e,"g",function(){return u}),a.d(e,"e",function(){return d}),a.d(e,"d",function(){return p}),a.d(e,"b",function(){return h}),a.d(e,"a",function(){return v});var n=a("//Fk"),r=a.n(n),i=a("mvHQ"),s=a.n(i),o=a("pFYg"),c=a.n(o),l=function(t,e,a){for(var n=0,r=e.length,i=!1;n<r;){if(t===e[n][a]){i=!0;break}n++}return i},u=function(t){return""+t.replace(/(^\s*)|(\s*$)/g,"")},d=function(){var t=new Date,e=t.getMonth()+1,a=t.getDate();return t.getFullYear()+"-"+(e>9?e:"0"+e)+"-"+(a>9?a:"0"+a)};f.prototype.getDateStr3=function(t){var e=t;return""+e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):""+(e.getMonth()+1))+"-"+(e.getDate()<10?"0"+e.getDate():""+e.getDate())},f.prototype.getWeekStartAndEnd=function(t){var e=new Date,a=(e=new Date(e.getTime()+6048e5*t)).getDay(),n=(e.getDate(),0!=a?a-1:6),r=new Date(e.getTime()-864e5*n),i=new Date(r.getTime()+5184e5);return this.getDateStr3(r)+" - "+this.getDateStr3(i)};var p=function(t,e,a){t=t;var n=e?new Date(e):new Date,r=n.getFullYear(),i=n.getMonth()+1,s=n.getDate();return s<=t&&(i>1?i-=1:(r-=1,i=12)),"before"===a?n.setDate(n.getDate()-t):n.setDate(n.getDate()+t),r=n.getFullYear(),i=n.getMonth()+1,s=n.getDate(),r+"-"+(i<10?"0"+i:i)+"-"+(s<10?"0"+s:s)};function f(t){this.date=t.date,this.type=t.type,this.value=void 0!==t.value?t.value:0,this.format=void 0!==t.format?t.format:"yyyy/MM/dd",this.date instanceof Date?(this.year=this.date.getFullYear(),this.month=this.date.getMonth()+1,this.day=this.date.getDate()):(this.year=this.date.substr(0,4),this.month=this.date.substr(5,2),this.day=this.date.substr(8,2))}f.prototype.beforeDate=function(t,e){var a=t||this.type,n=e||this.value,r=this.year,i=this.month,s=this.day;"year"===a||"年"===a?r-=n:"month"===a||"月"===a?(r-=parseInt(n/12),(i-=n%12)<=0&&(r-=1,i+=12)):"day"!==a&&"日"!==a||(s-=n%30)<=0&&(r-=1,i+=12);var o=new Date(r,i-1,s);return this.formatDate(o,this.format)},f.prototype.formatDate=function(t,e){var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e},f.prototype.getThisMonth=function(){var t=new Date(this.year,this.month-1),e=new Date(this.year,this.month,0);return this.formatDate(t,this.format)+" - "+this.formatDate(e,this.format)},f.prototype.getSomeMonth=function(t){return this.beforeDate("month",t)+" - "+this.beforeDate("now",0)},f.prototype.getThisYear=function(){var t=new Date(this.year,0,1),e=new Date(this.year,11,31);return this.formatDate(t,this.format)+" - "+this.formatDate(e,this.format)},f.prototype.formatTimeStr=function(t){var e=new Date,a=parseInt(e.getTime()),n=new Date(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+(e.getDate()-1)+" 00:00:01"),r=new Date(t),i=(a-t)/1e3;return i>=31536e3||r.getFullYear()!=e.getFullYear()?r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate():i>259200?r.getMonth()+1+"-"+r.getDate():r.getDate()==n.getDate()?"昨天":i>86400?Math.ceil(i/86400)+"天前":i>3600?Math.floor(i/3600)+"小时前":i>60?Math.floor(i/60)+"分钟前":"刚刚"};var h=new f({date:"2018-06-01",type:"month",value:"14",format:"yyyy-MM-dd hh:mm:ss"}),m=function(t){var e,a,n,r={url:location.href,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,xhr:function(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){return new ActiveXObject("Microsoft.XMLHTTP")}}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript, application/x-javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},i={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},s=(new Date).getTime(),o=/\[\]$/,l=/\=\?(&|$)/,u=/\?/,d=/%20/g,p=/\S/,f={},h={},m=function t(){var e,a,n,r,i,s,o=arguments[0]||{},l=arguments.length;for(e=1;e<l;++e)if(null!=(a=arguments[e]))for(s in a)n=o[s],r=a[s],o!==r&&("object"===(void 0===r?"undefined":c()(r))?(i=n&&"object"===(void 0===n?"undefined":c()(n))?n:{},o[s]=t(i,r)):void 0!==r&&(o[s]=r));return o}(r,t),v=m.type.toUpperCase(),g=/^(?:GET|HEAD)$/.test(v);if(m.url=m.url.replace(/#.*$/,""),m.context=t&&null!=t.context?t.context:m,m.data&&m.processData&&"string"!=typeof m.data&&(m.data=function(t){var e,a=[],n=function(t,e){e=k(e)?e():e,a[a.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(E(t))for(e in t)n(e,t[e]);else for(var r in t)R(r,t[r],n);return a.join("&").replace(d,"+")}(m.data)),"jsonp"===m.dataType&&("GET"===v?l.test(m.url)||(m.url+=(u.test(m.url)?"&":"?")+(m.jsonp||"callback")+"=?"):m.data&&l.test(m.data)||(m.data=(m.data?m.data+"&":"")+(m.jsonp||"callback")+"=?"),m.dataType="json"),"json"===m.dataType&&(m.data&&l.test(m.data)||l.test(m.url))){e=m.jsonpCallback||"jsonp"+s++,m.data&&(m.data=(m.data+"").replace(l,"="+e+"$1")),m.url=m.url.replace(l,"="+e+"$1"),m.dataType="script";var y=window[e];window[e]=function(t){if(k(y))y(t);else{window[e]=void 0;try{delete window[e]}catch(t){}}j(m,D,a,n=t),A(m,D,a),b&&b.removeChild(_)}}m.data&&g&&(m.url+=(u.test(m.url)?"&":"?")+m.data);var w=/^(\w+:)?\/\/([^\/?#]+)/.exec(m.url),x=w&&(w[1]&&w[1].toLowerCase()!==location.protocol||w[2].toLowerCase()!==location.host);if("script"===m.dataType&&"GET"===v&&x){var b=document.getElementsByTagName("head")[0]||document.documentElement,_=document.createElement("script");if(m.scriptCharset&&(_.charset=m.scriptCharset),_.src=m.url,!e){var C=!1;_.onload=_.onreadystatechange=function(){C||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(C=!0,j(m,D,a,n),A(m,D,a),_.onload=_.onreadystatechange=null,b&&_.parentNode&&b.removeChild(_))}}b.insertBefore(_,b.firstChild)}else{var T=!1,D=m.xhr();if(D){m.username?D.open(v,m.url,m.async,m.username,m.password):D.open(v,m.url,m.async),m.withCredentials&&"withCredentials"in D&&(D.withCredentials=!0);try{(null!=m.data&&!g||t&&t.contentType)&&D.setRequestHeader("Content-Type",m.contentType),m.ifModified&&(f[m.url]&&D.setRequestHeader("If-Modified-Since",f[m.url]),h[m.url]&&D.setRequestHeader("If-None-Match",h[m.url])),x||D.setRequestHeader("X-Requested-With","XMLHttpRequest"),D.setRequestHeader("Accept",m.dataType&&m.accepts[m.dataType]?m.accepts[m.dataType]+", */*; q=0.01":m.accepts._default)}catch(t){}if(m.beforeSend&&!1===m.beforeSend.call(m.context,D,m))return D.abort(),!1;var S=D.onreadystatechange=function(t){if(D&&0!==D.readyState&&"abort"!==t){if(!T&&D&&(4===D.readyState||"timeout"===t)){var r;if(T=!0,D.onreadystatechange=L,"success"===(a="timeout"===t?"timeout":function(t){try{return!t.status&&"file:"===location.protocol||t.status>=200&&t.status<300||304===t.status||1223===t.status}catch(t){}return!1}(D)?m.ifModified&&function(t,e){var a=t.getResponseHeader("Last-Modified"),n=t.getResponseHeader("Etag");a&&(a[e]=a);n&&(n[e]=n);return 304===t.status}(D,m.url)?"notmodified":"success":"error"))try{n=function(t,e,a){var n=t.getResponseHeader("content-type")||"",r="xml"===e||!e&&n.indexOf("xml")>=0,i=r?t.responseXML:t.responseText;if(r&&"parsererror"===i.documentElement.nodeName)throw"parsererror";a&&a.dataFilter&&(i=a.dataFilter(i,e));"string"==typeof i&&("json"===e||!e&&n.indexOf("json")>=0?i=JSON.parse(i):("script"===e||!e&&n.indexOf("javascript")>=0)&&function(t){if(t&&p.test(t)){var e=document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("script");a.type="text/javascript",scriptEval?a.appendChild(document.createTextNode(t)):a.text=t,e.insertBefore(a,e.firstChild),e.removeChild(a)}}(i));return i}(D,m.dataType,m)}catch(t){a="parsererror",r=t}"success"===a||"notmodified"===a?e||j(m,D,a,n):M(m,D,a,r),e||A(m,D,a),"timeout"===t&&D.abort(),m.async&&(D=null)}}else T||A(m,D,a),T=!0,D&&(D.onreadystatechange=L)};try{var F=D.abort;D.abort=function(){D&&Function.prototype.call.call(F,D),S("abort")}}catch(t){}m.async&&m.timeout>0&&setTimeout(function(){D&&!T&&S("timeout")},m.timeout);try{D.send(g||null==m.data?null:m.data)}catch(t){M(m,D,null,t),A(m,D,a)}return m.async||S(),D}}function I(t){return null==t?String(t):i[toString.call(t)]||"object"}function k(t){return"function"===I(t)}function E(t){return"array"===I(t)}function R(t,e,a){if(E(e)&&e.length)for(var n in e){var r=e[n];o.test(t)?a(t,r):R(t+"["+("object"===(void 0===r?"undefined":c()(r))||E(r)?n:"")+"]",r,a)}else if(null!=e&&"object"===(void 0===e?"undefined":c()(e)))if(function(t){for(var e in t)return!1;return!0}(e))a(t,"");else for(var i in e){R(t+"["+i+"]",r=e[i],a)}else a(t,e)}function M(t,e,a,n){"function"==typeof t.error&&t.error.call(t.context,e,a,n)}function j(t,e,a,n){"function"==typeof t.success&&t.success.call(t.context,n,a,e)}function A(t,e,a){"function"==typeof t.complete&&t.complete.call(t.context,e,a)}function L(){}},v=function(t){var e,a,n=t.data;return"string"==typeof t.dataType&&"string"==typeof t.type&&"json"===(e=t.dataType.toLowerCase())&&"post"===t.type.toLowerCase()&&(n=s()(t.data)),"string"==typeof t.contentType&&(a=t.contentType.toLowerCase()),new r.a(function(r,i){m({url:t.url||"url",type:t.type||"GET",async:!1!==t.async,withCredentials:t.withCredentials,data:n,dataType:e||"default",contentType:a||"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:function(){return"function"!=typeof t.beforeSend||t.beforeSend()},success:function(t,e,a,n){r(t,e,a,n)},error:function(t,e,a,n){i({responseText:t.responseText,code:t.status})},complete:function(t,e,a){r(t,e,a)}})})};e.c=f},obFR:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),r=a.n(n),i=a("7+uW"),s=a("mtWM"),o=a.n(s),c=a("oAV5"),l=a("BD2p");window.task_flow_version="beiyi_flow";var u={data:function(){return{assignee:pageDataObject.assignee,flowStartDate:c.b.formatDate(new Date(pageDataObject.flowStartDate),"yyyy-MM-dd hh:mm:ss"),flowEndDate:c.b.formatDate(new Date(pageDataObject.flowEndDate),"yyyy-MM-dd hh:mm:ss"),staticText:{subtitle:["填写上门服务预约申请表","任务操作指引","参考话术","任务操作","微信群再次确认","任务操作说明"],label:["商户名称：","上门服务类型：","上门目的：","预约上门时间：","上门服务时间：","上门服务项目：","服务情况备注：","附件：","输入实际上门服务时间","完成服务项目请勾选","交付培训验收单"],plan:{columns:["准备项","准备内容"]}},uploadAction:ctx+"/workfile/file/uploads",uploadUrl:pageDataObject.uploadfileurl,taskId:erpApp.getQueryString("taskId"),procInsId:erpApp.getQueryString("procInsId"),plan:["服务员培训"],tip:{a:!1,b:!1},serviceStartTime:"",serviceEndTime:"",formData:{shop:{name:"",id:""},tableContent:[],serviceData:{id:"",shopInfoId:"",shopInfoName:"",serviceAddress:"",serviceTypeCode:"1",serviceTypeTxt:"",serviceGoalCode:"2",serviceGoalTxt:"",serviceGoal:"",serviceUser:"",serviceUserName:"",servicePreparationInfo:"",shopAttendees:"",shopPreparationInfo:"",trainRecorder:"",serviceReason:"",shopNeedsPicture:"",appointedStartTime:"",appointedEndTime:"",auditStatus:"",auditUser:"",auditUserName:"",cancelReason:"",modifySuggest:"",receivingReport:"",procInsId:"",itemRecords:[]}},channelType:[],itemRecords:[],receivingReport:[],fmt:["7z","aiff","asf","avi","bmp","csv","doc","docx","fla","flv","gif","gz","gzip","jpeg","jpg","mid","mov","mp3","mp4","mpc","mpeg","mpg","ods","odt","pdf","png","ppt","pptx","pxd","qt","ram","rar","rm","rmi","rmvb","rtf","sdc","sitd","swf","sxc","sxw","tar","tgz","tif","tiff","txt","vsd","wav","wma","wmv","xls","xlsx","xlsm","zip"]}},components:{upload:l.a},computed:{datas:function(){return{taskId:this.taskId,procInsId:this.procInsId,fileId:"",fileUrl:""}},contentData:function(){return this.formData}},mounted:function(){this.getDoorDetail()},methods:{clickHandler:function(){var t=this,e=[],a=[];if(this.receivingReport.length>0&&this.receivingReport.forEach(function(t,a){t.id&&e.length<5&&e.push(t.id)}),this.itemRecords.forEach(function(e){a.push({completeFlag:e.completeFlag?"Y":"N",serviceEndTime:e.completeFlag?t.serviceEndTime:"",serviceItem:e.serviceItemTxt,serviceItemCode:e.serviceItemCode,serviceStartTime:e.completeFlag?t.serviceStartTime:"",serviceItemAttendees:e.serviceItemAttendees||"",serviceItemTxt:e.serviceItemTxt||"",serviceInfoId:e.serviceInfoId||""})}),this.serviceStartTime&&this.serviceEndTime)if(this.remark)if(0!==e.length){var n=e.join(";"),r={id:this.contentData.serviceData.id||"",remark:this.remark,serviceEndTime:this.serviceEndTime,serviceStartTime:this.serviceStartTime};erpApp.confirm("确定完成上门服务吗？",function(){o.a.post(ctx+"/visit/flow/visit_service_complete_material?taskId="+t.taskId+"&procInsId="+t.procInsId+"&receivingReport="+n,r).then(function(t){t.data.result?(erpApp.tip(t.data.message||"处理成功！"),erpApp.jumpToTasklistPage("beiyiTaskFlow")):erpApp.tip(t.data.message||"处理失败！")}).catch(function(t){erpApp.tip("处理失败，请稍后再重试！")})})}else erpApp.tip("请上传交付培训验收单附件！");else erpApp.tip("请填写服务情况备注！");else erpApp.tip("请填写实际上门服务时间！")},getDoorDetail:function(){var t=this;o.a.get(ctx+"/visit/flow/getDoorDetail",{params:{taskId:this.taskId,procInsId:this.procInsId,serviceGoalCode:"2"}}).then(function(e){e.data.result&&("object"===erpApp.util.type(e.data.shop)&&(t.formData.shop=erpApp.extend(!0,t.formData.shop,e.data.shop)),"object"===erpApp.util.type(e.data.result1)&&(t.formData.serviceData=erpApp.extend(!0,t.formData.serviceData,e.data.result1),e.data.result1.receivingReport&&(t.receivingReport=e.data.result1.receivingReport.split(";")),Array.isArray(e.data.result1.itemRecords)&&(e.data.result1.itemRecords.map(function(t){return t.completeFlag="Y"===t.completeFlag,t}),t.itemRecords=e.data.result1.itemRecords)),Array.isArray(e.data.result2)&&(t.formData.tableContent=e.data.result2))})},changeTime:function(t,e){var a=t.target.value?t.target.value:"";this[e]=a},removeFile:function(t){var e=this;erpApp.confirm("确定要删除该附件吗？",function(){e.receivingReport.splice(t,1),erpApp.tip("删除成功！")})},handleSuccess:function(t,e){this.receivingReport.length>=5?erpApp.tip("最多只能上传5个附件！"):"SUCCESS"===t.state?this.receivingReport.push({id:t.orderFileId,file_name:t.fileName,file_path:t.fileUrl}):erpApp.tip("文件 "+e.name+"上传失败！","error");var a=this.$refs.uploadFile.fileList;this.$refs.uploadFile.fileList.splice(a.indexOf(e),1),this.receivingReport.splice(5,1e3)},handleFormatError:function(t){erpShopApp.tip("文件 "+t.name+" 格式不正确。","error")},handleMaxSize:function(t){erpShopApp.tip("文件 "+t.name+" 太大，不能超过 50M。","error")},beforeupload:function(t){if(this.receivingReport.length>=5)return erpApp.tip("最多只能上传5个附件！"),!1}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"taskflow-content"},[a("div",{staticClass:"task-detail-wrapper",attrs:{id:"taskDetailWrapper"}},[a("h3",{staticClass:"task-title"},[t._v("上门服务完成")]),t._v(" "),a("div",{staticClass:"task-sider"},[a("div",{staticClass:"task-sider-subtitlec"},[a("i",{staticClass:"icon-wrench"}),a("span",[t._v(t._s(t.staticText.subtitle[3]))])]),t._v(" "),a("div",{staticClass:"task-sider-content"},[a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[0]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[t._v("基础服务")])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[1]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[t._v("首次营销策划服务")])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[2]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[t._v("二次上门服务")])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[3]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"}),a("dd",{staticClass:"margin-left-120"},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.contentData.serviceData.appointedStartTime)+" — "+t._s(t.contentData.serviceData.appointedEndTime)+"\n\t\t\t\t\t\t")])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[4]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[a("div",{staticClass:"sub-infos"},[t._v(t._s(t.staticText.label[8]))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.serviceStartTime,expression:"serviceStartTime"}],attrs:{type:"text",id:"appointedStartTime",onclick:"WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss', isShowClear:false, readOnly:true});"},domProps:{value:t.serviceStartTime},on:{focus:function(e){t.changeTime(e,"serviceStartTime")},input:function(e){e.target.composing||(t.serviceStartTime=e.target.value)}}}),t._v(" — \n\t\t\t\t\t\t"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.serviceEndTime,expression:"serviceEndTime"}],attrs:{type:"text",id:"appointedEndTime",onclick:"WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss', isShowClear:false, minDate:'#F{$dp.$D(\\'appointedStartTime\\');}', readOnly:true});"},domProps:{value:t.serviceEndTime},on:{focus:function(e){t.changeTime(e,"serviceEndTime")},input:function(e){e.target.composing||(t.serviceEndTime=e.target.value)}}})])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[5]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[a("div",{staticClass:"sub-infos"},[t._v(t._s(t.staticText.label[9]))]),t._v(" "),a("div",{staticClass:"content-wrap-table"},[a("table",{staticClass:"table table-striped table-bordered"},[a("thead",[a("tr",t._l(t.staticText.plan.columns,function(e,n){return a("th",{key:"cl_"+n},[t._v(t._s(e))])}))]),t._v(" "),a("tbody",t._l(t.itemRecords,function(e,n){return a("tr",{key:"row_"+n},[a("td",[t._v(t._s(e.serviceItemTxt))]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.completeFlag,expression:"row.completeFlag"}],attrs:{type:"checkbox",value:"Y"},domProps:{checked:Array.isArray(e.completeFlag)?t._i(e.completeFlag,"Y")>-1:e.completeFlag},on:{change:function(a){var n=e.completeFlag,r=a.target,i=!!r.checked;if(Array.isArray(n)){var s=t._i(n,"Y");r.checked?s<0&&(e.completeFlag=n.concat(["Y"])):s>-1&&(e.completeFlag=n.slice(0,s).concat(n.slice(s+1)))}else t.$set(e,"completeFlag",i)}}})])])}))])])])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[6]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[a("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.remark,expression:"remark",modifiers:{trim:!0}}],staticClass:"content-textarea",attrs:{maxlength:"100"},domProps:{value:t.remark},on:{input:function(e){e.target.composing||(t.remark=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),a("dl",{staticClass:"content-wrap"},[a("dt",[t._v(t._s(t.staticText.label[7]))]),t._v(" "),a("dd",{staticClass:"margin-left-120"},[a("div",{staticClass:"sub-infos"},[t._v(t._s(t.staticText.label[10]))]),t._v(" "),a("div",{staticClass:"upload-img"},[a("upload",{ref:"uploadFile",staticStyle:{display:"inline-block",width:"76px"},attrs:{type:"drag","on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.beforeupload,format:t.fmt,"max-size":51200,action:t.uploadAction,multiple:"",data:t.datas}},[a("div",{staticStyle:{width:"76px",height:"30px","line-height":"30px","text-align":"center"}},[a("span",[a("i",{staticClass:"icon-camera"}),t._v("上传")])])])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.receivingReport.length>0,expression:"receivingReport.length>0"}],staticClass:"imgs"},[t._l(t.receivingReport,function(e,n){return[e?a("div",{staticClass:"file-list"},[a("div",{directives:[{name:"show",rawName:"v-show",value:n<5,expression:"inx < 5"}]},[a("span",[t._v(t._s(e.file_name))]),t._v(t._s(n)+"\n\t\t\t\t\t\t\t\t\t\t"),a("a",{attrs:{href:"javascript:;",title:"删除"},on:{click:function(e){t.removeFile(n)}}},[a("i",{staticClass:"icon-remove"})])])]):t._e()]})],2)])])])]),t._v(" "),a("div",{staticClass:"task-detail-footer"},[a("div",{staticClass:"footer-info"},[a("p",[t._v("负责人："+t._s(t.assignee))]),t._v(" "),a("p",[t._v(t._s(t.flowStartDate)+" —— "+t._s(t.flowEndDate))])]),t._v(" "),a("div",{staticClass:"footer-btn"},[a("button",{staticClass:"btn btn-primary btn-large",attrs:{type:"button"},on:{click:t.clickHandler}},[t._v("确定完成")])])])])])},staticRenderFns:[]},p=a("VU/8")(u,d,!1,null,null,null).exports;i.default.config.productionTip=!1,i.default.config.devtools=!1,new i.default(r()({},p)).$mount("#rootNode")}},["obFR"]);