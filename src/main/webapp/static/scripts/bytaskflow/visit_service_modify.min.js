webpackJsonp([54],{BD2p:function(e,t,s){"use strict";var a=s("bOdI"),n=s.n(a),i={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return"ivu-icon ivu-icon-"+this.type},styles:function(){var e={};return this.size&&(e["font-size"]=this.size+"px"),this.color&&(e.color=this.color),e}}},r={render:function(){var e=this.$createElement;return(this._self._c||e)("i",{class:this.classes,style:this.styles})},staticRenderFns:[]},o=s("VU/8")(i,r,!1,null,null,null).exports,c=(s("BO1k"),s("7+uW").default.prototype.$isServer);function l(e,t){for(var s=0;s<t.length;s++)if(e===t[s])return!0;return!1}!c&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver);var u={components:{Icon:o},props:{percent:{type:Number,default:0},status:{validator:function(e){return l(e,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1}},data:function(){return{currentStatus:this.status}},computed:{isStatus:function(){return"wrong"==this.currentStatus||"success"==this.currentStatus},statusIcon:function(){var e="";switch(this.currentStatus){case"wrong":e="ios-close";break;case"success":e="ios-checkmark"}return e},bgStyle:function(){return this.vertical?{height:this.percent+"%",width:this.strokeWidth+"px"}:{width:this.percent+"%",height:this.strokeWidth+"px"}},wrapClasses:function(){var e;return["ivu-progress","ivu-progress-"+this.currentStatus,(e={},n()(e,"ivu-progress-show-info",!this.hideInfo),n()(e,"ivu-progress-vertical",this.vertical),e)]},textClasses:function(){return"ivu-progress-text"},textInnerClasses:function(){return"ivu-progress-text-inner"},outerClasses:function(){return"ivu-progress-outer"},innerClasses:function(){return"ivu-progress-inner"},bgClasses:function(){return"ivu-progress-bg"}},created:function(){this.handleStatus()},methods:{handleStatus:function(e){e?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100==parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent:function(e,t){e<t?this.handleStatus(!0):this.handleStatus()},status:function(e){this.currentStatus=e}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.wrapClasses},[s("div",{class:e.outerClasses},[s("div",{class:e.innerClasses},[s("div",{class:e.bgClasses,style:e.bgStyle})])]),e._v(" "),e.hideInfo?e._e():s("span",{class:e.textClasses},[e._t("default",[e.isStatus?s("span",{class:e.textInnerClasses},[s("Icon",{attrs:{type:e.statusIcon}})],1):s("span",{class:e.textInnerClasses},[e._v("\n                "+e._s(e.percent)+"%\n            ")])])],2)])},staticRenderFns:[]},p={name:"UploadList",components:{Icon:o,iProgress:s("VU/8")(u,d,!1,null,null,null).exports},props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(e){return["ivu-upload-list-file",n()({},"ivu-upload-list-file-finish","finished"===e.status)]},handleClick:function(e){this.$emit("on-file-click",e)},handlePreview:function(e){this.$emit("on-file-preview",e)},handleRemove:function(e){this.$emit("on-file-remove",e)},format:function(e){var t=e.name.split(".").pop().toLocaleLowerCase()||"",s="document";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(t)>-1&&(s="image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(t)>-1&&(s="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(t)>-1&&(s="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(t)>-1&&(s="document-text"),["numbers","csv","xls","xlsx"].indexOf(t)>-1&&(s="stats-bars"),["keynote","ppt","pptx"].indexOf(t)>-1&&(s="ios-videocam"),s},parsePercentage:function(e){return parseInt(e,10)}}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",{class:[e.prefixCls+"-list"]},e._l(e.files,function(t){return s("li",{class:e.fileCls(t),on:{click:function(s){e.handleClick(t)}}},[s("span",{on:{click:function(s){e.handlePreview(t)}}},[s("Icon",{attrs:{type:e.format(t)}}),e._v(" "+e._s(t.name)+"\n        ")],1),e._v(" "),s("Icon",{directives:[{name:"show",rawName:"v-show",value:"finished"===t.status,expression:"file.status === 'finished'"}],class:[e.prefixCls+"-list-remove"],attrs:{type:"ios-close-empty"},nativeOn:{click:function(s){e.handleRemove(t)}}}),e._v(" "),s("transition",{attrs:{name:"fade"}},[t.showProgress?s("i-progress",{attrs:{"stroke-width":2,percent:e.parsePercentage(t.percentage),status:"finished"===t.status&&t.showProgress?"success":"normal"}}):e._e()],1)],1)}))},staticRenderFns:[]},h=s("VU/8")(p,f,!1,null,null,null).exports,v=s("fZjL"),m=s.n(v);function g(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}function y(e){if("undefined"!=typeof XMLHttpRequest){var t=new XMLHttpRequest,s=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var a=new FormData;e.data&&m()(e.data).map(function(t){a.append(t,e.data[t])}),a.append(e.filename,e.file),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(function(e,t,s){var a="fail to post "+e+" "+s.status+"'",n=new Error(a);return n.status=s.status,n.method="post",n.url=e,n}(s,0,t),g(t));e.onSuccess(g(t))},t.open("post",s,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var n=e.headers||{};for(var i in n)n.hasOwnProperty(i)&&null!==n[i]&&t.setRequestHeader(i,n[i]);t.send(a)}}var x={name:"Upload",mixins:[{methods:{dispatch:function(e,t,s){for(var a=this.$parent||this.$root,n=a.$options.name;a&&(!n||n!==e);)(a=a.$parent)&&(n=a.$options.name);a&&a.$emit.apply(a,[t].concat(s))},broadcast:function(e,t,s){(function e(t,s,a){this.$children.forEach(function(n){n.$options.name===t?n.$emit.apply(n,[s].concat(a)):e.apply(n,[t,s].concat([a]))})}).call(this,e,t,s)}}}],components:{UploadList:h},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(e){return l(e,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},maxSelectNum:{type:Number},existNum:{type:Number},index:{type:Number}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var e;return["ivu-upload",(e={},n()(e,"ivu-upload-select","select"===this.type),n()(e,"ivu-upload-drag","drag"===this.type),n()(e,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),e)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(e){var t=e.target.files;t&&(this.uploadFiles(t),this.$refs.input.value=null)},onDrop:function(e){this.dragOver=!1,this.uploadFiles(e.dataTransfer.files)},uploadFiles:function(e){var t=this,s=Array.prototype.slice.call(e);if(this.maxSelectNum&&s.length>this.maxSelectNum-this.existNum)return erpShopApp.tip("最多只能上传"+this.maxSelectNum+"张图片！","info"),!1;this.multiple||(s=s.slice(0,1)),0!==s.length&&s.forEach(function(e){t.upload(e)})},upload:function(e){var t=this;if(!this.beforeUpload)return this.post(e);var s=this.beforeUpload(e,this.index);s&&s.then?s.then(function(s){"[object File]"===Object.prototype.toString.call(s)?t.post(s):t.post(e)},function(){}):!1!==s&&this.post(e)},post:function(e){var t=this;if(this.format.length){var s=e.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(e){return e.toLocaleLowerCase()===s}))return this.onFormatError(e,this.fileList),!1}if(this.maxSize&&e.size>1024*this.maxSize)return this.onExceededSize(e,this.fileList),!1;this.handleStart(e),(new FormData).append(this.name,e),y({headers:this.headers,withCredentials:this.withCredentials,file:e,data:this.data,filename:this.name,action:this.action,onProgress:function(s){t.handleProgress(s,e)},onSuccess:function(s){t.handleSuccess(s,e,t.index)},onError:function(s,a){t.handleError(s,a,e)}})},handleStart:function(e){e.uid=Date.now()+this.tempIndex++;var t={status:"uploading",name:e.name,size:e.size,percentage:0,uid:e.uid,showProgress:!0};this.fileList.push(t)},getFile:function(e){var t=void 0;return this.fileList.every(function(s){return!(t=e.uid===s.uid?s:null)}),t},handleProgress:function(e,t){var s=this.getFile(t);this.onProgress(e,s,this.fileList),s.percentage=e.percent||0},handleSuccess:function(e,t,s){var a=this.getFile(t);a&&(a.status="finished",a.response=e,this.dispatch("FormItem","on-form-change",a),this.onSuccess(e,a,this.fileList,s),setTimeout(function(){a.showProgress=!1},1e3))},handleError:function(e,t,s){var a=this.getFile(s),n=this.fileList;a.status="fail",n.splice(n.indexOf(a),1),this.onError(e,t,s)},handleRemove:function(e){var t=this.fileList;t.splice(t.indexOf(e),1),this.onRemove(e,t)},handlePreview:function(e){"finished"===e.status&&this.onPreview(e)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(e){var t=this;this.fileList=e.map(function(e){return e.status="finished",e.percentage=100,e.uid=Date.now()+t.tempIndex++,e})}}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:[e.prefixCls]},[s("div",{class:e.classes,on:{click:e.handleClick,drop:function(t){t.preventDefault(),e.onDrop(t)},dragover:function(t){t.preventDefault(),e.dragOver=!0},dragleave:function(t){t.preventDefault(),e.dragOver=!1}}},[s("input",{ref:"input",class:[e.prefixCls+"-input"],attrs:{type:"file",multiple:e.multiple,accept:e.accept},on:{change:e.handleChange}}),e._v(" "),e._t("default")],2),e._v(" "),e._t("tip"),e._v(" "),e.showUploadList?s("upload-list",{attrs:{files:e.fileList},on:{"on-file-remove":e.handleRemove,"on-file-preview":e.handlePreview}}):e._e()],2)},staticRenderFns:[]},w=s("VU/8")(x,b,!1,null,null,null);t.a=w.exports},"J2l+":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),n=s.n(a),i=s("7+uW"),r=s("mtWM"),o=s.n(r),c=s("oAV5"),l=s("RXbT");window.task_flow_version="afterSales_flow";var u={data:function(){return{assignee:pageDataObject.assignee,flowStartDate:c.b.formatDate(new Date(pageDataObject.flowStartDate),"yyyy-MM-dd hh:mm:ss"),flowEndDate:c.b.formatDate(new Date(pageDataObject.flowEndDate),"yyyy-MM-dd hh:mm:ss"),taskId:erpApp.getQueryString("taskId"),procInsId:erpApp.getQueryString("procInsId"),modifySuggests:""}},components:{visitservice:l.a},methods:{clickHandler:function(){var e=this,t={shopInfoName:"请选择商户！",serviceAddress:"请填写上门地址！",serviceGoalTxt:"请选择上门目的！",serviceReason:"请填写上门服务原因！",shopNeedsPicture:"请上传客户需求截图！",appointedStartTime:"请填写预约上门开始时间！",appointedEndTime:"请填写预约上门结束时间！"},s=this.$refs.afterSalesComponent.getData();for(var a in t)if(!s[a])return void erpApp.tip(t[a]);if(0!==s.itemRecords.filter(function(e){return"Y"===e.completeFlag}).length){erpApp.confirm("确定要提交审核吗？",function(){o.a.post(ctx+"/afterSales/flow/visit_service_apply?procInsId="+e.procInsId+"&taskId="+e.taskId+"&channelType=Pass",s).then(function(e){e.data.result?(erpApp.tip(e.data.message||"提交成功！"),erpApp.jumpToTasklistPage("beiyiTaskFlow")):erpApp.tip(e.data.message||"提交失败！")}).catch(function(e){erpApp.tip("提交失败，请稍后再重试！")})})}else erpApp.tip("请选择上门服务项！")},modifySuggest:function(e){this.modifySuggests=e}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"taskflow-content"},[s("div",{staticClass:"task-detail-wrapper",attrs:{id:"taskDetailWrapper"}},[s("h3",{staticClass:"task-title"},[e._v("修改售后上门服务")]),e._v(" "),s("div",{staticClass:"task-sider"},[s("div",{staticClass:"task-sider-title"},[e._v("修改建议")]),e._v(" "),s("div",{staticClass:"content-wrap"},[s("div",{staticClass:"hsck"},[e._v(e._s(e.modifySuggests))])])]),e._v(" "),s("h3",{staticClass:"task-title"},[e._v("上门服务内容")]),e._v(" "),s("div",{staticClass:"task-sider"},[s("visitservice",{ref:"afterSalesComponent",attrs:{taskId:e.taskId,procInsId:e.procInsId},on:{getInfo:e.modifySuggest}})],1),e._v(" "),s("div",{staticClass:"task-detail-footer"},[s("div",{staticClass:"footer-info"},[s("p",[e._v("负责人："+e._s(e.assignee))]),e._v(" "),s("p",[e._v(e._s(e.flowStartDate)+" —— "+e._s(e.flowEndDate))])]),e._v(" "),s("div",{staticClass:"footer-btn"},[s("button",{staticClass:"btn btn-primary btn-large",attrs:{type:"button"},on:{click:e.clickHandler}},[e._v("提交申请")])])])])])},staticRenderFns:[]},p=s("VU/8")(u,d,!1,null,null,null).exports;i.default.config.productionTip=!1,i.default.config.devtools=!1,new i.default(n()({},p)).$mount("#rootNode")},RXbT:function(e,t,s){"use strict";var a=s("mtWM"),n=s.n(a),i={props:["isDisabled","taskId","procInsId","isComplete"],data:function(){return{uploadAction:ctx+"/workfile/file/uploads",uploadUrl:pageDataObject.uploadfileurl,serviceItemDataSelect:[],serviceGoals:[],shopNeedsPicture:[],storeList:[],info:{id:"",shopInfoId:"",shopInfoName:"",serviceAddress:"",serviceTypeCode:"",serviceTypeTxt:"",serviceGoalCode:"4",serviceGoalTxt:"",serviceGoal:"",serviceUser:"",serviceUserName:"",servicePreparationInfo:"",shopAttendees:"",shopPreparationInfo:"",trainRecorder:"",serviceReason:"",shopNeedsPicture:"",appointedStartTime:"",appointedEndTime:"",auditStatus:"",auditStatusTxt:"",auditUser:"",auditUserName:"",cancelReason:"",modifySuggest:"",receivingReport:"",procInsId:"",itemRecords:[]}}},components:{upload:s("BD2p").a},computed:{datas:function(){return{taskId:this.taskId,procInsId:this.procInsId,fileId:"",fileUrl:""}}},mounted:function(){this.getCode()},methods:{getCode:function(){var e=this;n.a.get(ctx+"/afterSales/flow/getDoorDetail",{params:{procInsId:this.procInsId}}).then(function(t){t.data.result&&t.data.serviceGoalCode&&t.data.shopInfoId&&e.getDoorDetail(t.data.serviceGoalCode,t.data.shopInfoId)})},getDoorDetail:function(e,t){var s=this;n.a.get(ctx+"/afterSales/flow/getDoorDetails",{params:{taskId:this.taskId,procInsId:this.procInsId,serviceGoalCode:e,shopInfoId:t}}).then(function(e){e.data.result&&"object"===erpApp.util.type(e.data.result1)&&(s.serviceGoals=e.data.result1.serviceGoalTxt.split(","),s.shopNeedsPicture=e.data.result1.shopNeedsPicture.split(";"),Array.isArray(e.data.result1.itemRecords)&&e.data.result1.itemRecords.forEach(function(e){"Y"===e.completeFlag&&s.serviceItemDataSelect.push(e)}),s.info=erpApp.extend(!0,s.info,e.data.result1),e.data.result1.shopInfoId&&s.getStoreList(e.data.result1.shopInfoId),s.$emit("getInfo",e.data.result1.modifySuggest,e.data.result1.appointedEndTime,e.data.result1.itemRecords))})},getStoreList:function(e){var t=this;e&&n.a.get(ctx+"/store/basic/erpStoreInfo/getlist/?id="+e).then(function(e){Array.isArray(e.data.storelist)&&(t.storeList=e.data.storelist)})},getData:function(){var e=this;return this.serviceItemDataSelect.length>0&&this.info.itemRecords.forEach(function(t,s){e.serviceItemDataSelect.forEach(function(e,s){e.serviceItemCode===t.serviceItemCode&&(t.completeFlag="Y")})}),this.info.shopNeedsPicture=this.shopNeedsPicture.join(";").replace(/(;*$)/g,""),this.info},changeDate:function(e,t){this.isDisabled||(this[t]=e.currentTarget.value)},selectUser:function(){var e=this;if(!this.isDisabled){erpApp.selectShopUser(ctx+"/shop/erpShopInfo/shopSearchList",function(t,s){e.info.shopInfoId=t,e.info.shopInfoName=s})}},selectStroeAddress:function(){var e=this;if(!this.isDisabled)if(0!==this.storeList.length){erpApp.selectStroeAddress(this.storeList,function(t){e.info.serviceAddress=t})}else erpApp.tip("商户["+this.info.shopInfoName+"]还没有门店，无法选择！")},handleSuccess:function(e,t){if(this.shopNeedsPicture.length>5)return this.shopNeedsPicture.splice(4,this.shopNeedsPicture.length),erpApp.tip("最多只能上传5张图片！"),!1;"SUCCESS"===e.state?this.shopNeedsPicture.push(e.fileUrl):erpApp.tip("文件 "+t.name+"上传失败！","error");var s=this.$refs.productPhoto.fileList;this.$refs.productPhoto.fileList.splice(s.indexOf(t),1)},handleFormatError:function(e){erpShopApp.tip("文件 "+e.name+" 格式不正确，请上传 jpg 或 png 格式的图片。","info")},handleMaxSize:function(e){erpApp.tip("文件 "+e.name+" 太大，不能超过 20M。","info")},handleBefore:function(e){if(this.shopNeedsPicture.length>5)return this.shopNeedsPicture.splice(4,this.shopNeedsPicture.length),erpApp.tip("最多只能上传5张图片！"),!1},deleteImg:function(e){var t=this;if(!this.isDisabled){erpApp.confirm("确定要删除该图片吗？",function(){t.shopNeedsPicture.splice(e,1),erpApp.tip("删除成功！")})}}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mask-widget-server"},[s("div",{staticClass:"form-horizontal clearboth erpstore-horizontal"},[s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("商户：")]),e._v(" "),s("div",{staticClass:"controls"},[s("div",{staticClass:"input-append"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.info.shopInfoName,expression:"info.shopInfoName"}],staticClass:"tableform-input",attrs:{type:"text",maxlength:"100",disabled:"true"},domProps:{value:e.info.shopInfoName},on:{input:function(t){t.target.composing||e.$set(e.info,"shopInfoName",t.target.value)}}}),e._v(" "),s("a",{staticClass:"btn search-storelist-btn",on:{click:e.selectUser}},[s("i",{staticClass:"icon-search"})])])])]),e._v(" "),s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("上门地址：")]),e._v(" "),s("div",{staticClass:"controls"},[s("div",{staticClass:"input-append"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.info.serviceAddress,expression:"info.serviceAddress"}],attrs:{type:"text",cl:"",ass:"tableform-input",maxlength:"100",disabled:e.isDisabled},domProps:{value:e.info.serviceAddress},on:{input:function(t){t.target.composing||e.$set(e.info,"serviceAddress",t.target.value)}}}),e._v(" "),s("a",{staticClass:"btn search-storelist-btn",on:{click:e.selectStroeAddress}},[s("i",{staticClass:"icon-search"})])])])]),e._v(" "),s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("上门服务类型：")]),e._v(" "),s("div",{staticClass:"controls"},[e._v(e._s(e.info.serviceTypeTxt||"售后服务"))])]),e._v(" "),s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("上门目的：")]),e._v(" "),s("div",{staticClass:"controls"},[s("select",{directives:[{name:"model",rawName:"v-model",value:e.info.serviceGoalTxt,expression:"info.serviceGoalTxt"}],attrs:{disabled:e.isDisabled},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.info,"serviceGoalTxt",t.target.multiple?s:s[0])}}},[e._l(e.serviceGoals,function(t){return[s("option",{domProps:{value:t}},[e._v(e._s(t))])]})],2)])]),e._v(" "),s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("上门服务原因：")]),e._v(" "),s("div",{staticClass:"controls"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.info.serviceReason,expression:"info.serviceReason"}],staticClass:"erpstore-textarea",attrs:{maxlength:"100",placeHolder:"请输入上门服务信息",disabled:e.isDisabled},domProps:{value:e.info.serviceReason},on:{input:function(t){t.target.composing||e.$set(e.info,"serviceReason",t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"control-group",staticStyle:{overflow:"hidden"}},[s("label",{staticClass:"control-label"},[e._v("客户需求截图：")]),e._v(" "),s("div",{staticClass:"controls"},[e.shopNeedsPicture.length>0?e._l(e.shopNeedsPicture,function(t,a){return s("div",{staticClass:"img-content"},[s("div",{directives:[{name:"show",rawName:"v-show",value:a<5,expression:"index < 5"}]},[s("img",{attrs:{src:e.uploadUrl+"/"+t,alt:"客户需求截图"}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:a<5&&!e.isDisabled,expression:"index < 5 && !isDisabled"}]},[s("button",{staticClass:"ios-trash-outline",on:{click:function(t){e.deleteImg(a)}}},[e._v("删除")])])])}):e._e(),e._v(" "),e.isDisabled?e._e():s("div",[s("upload",{ref:"productPhoto",staticStyle:{display:"inline-block",width:"76px",float:"left"},attrs:{type:"drag","on-success":e.handleSuccess,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,format:["jpg","jpeg","png","gif"],accept:"image/*","max-size":20480,multiple:"","before-upload":e.handleBefore,action:e.uploadAction,data:e.datas}},[s("div",{staticStyle:{width:"76px",height:"76px","line-height":"76px","text-align":"center"}},[s("span",[s("i",{staticClass:"icon-camera"}),e._v("上传")])])])],1)],2)]),e._v(" "),e.isComplete?e._e():s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("上门服务项：")]),e._v(" "),e.isDisabled?s("div",{staticClass:"controls"},[e._l(e.serviceItemDataSelect,function(t,a){return["-1"!==t.serviceItemCode?s("p",[e._v("\n\t\t\t\t\t\t"+e._s(a+1)+"、"),s("label",{attrs:{for:a}},[e._v(e._s(t.serviceItem))])]):s("p",[e._v("\n\t\t\t\t\t\t"+e._s(a+1)+"、"),s("label",{attrs:{for:a}},[e._v("其他")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.serviceItem,expression:"item.serviceItem"}],staticClass:"erpstore-input",attrs:{type:"text",maxlength:"100",disabled:e.isDisabled},domProps:{value:t.serviceItem},on:{input:function(s){s.target.composing||e.$set(t,"serviceItem",s.target.value)}}})])]})],2):s("div",{staticClass:"controls"},[e._l(e.info.itemRecords,function(t,a){return["-1"!==t.serviceItemCode?s("p",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.serviceItemDataSelect,expression:"serviceItemDataSelect"}],attrs:{id:a,type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.serviceItemDataSelect)?e._i(e.serviceItemDataSelect,t)>-1:e.serviceItemDataSelect},on:{change:function(s){var a=e.serviceItemDataSelect,n=s.target,i=!!n.checked;if(Array.isArray(a)){var r=t,o=e._i(a,r);n.checked?o<0&&(e.serviceItemDataSelect=a.concat([r])):o>-1&&(e.serviceItemDataSelect=a.slice(0,o).concat(a.slice(o+1)))}else e.serviceItemDataSelect=i}}}),e._v("\n\t\t\t\t\t\t"+e._s(a+1)+"、"),s("label",{attrs:{for:a}},[e._v(e._s(t.serviceItem))])]):s("p",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.serviceItemDataSelect,expression:"serviceItemDataSelect"}],attrs:{id:a,type:"checkbox"},domProps:{value:t,checked:Array.isArray(e.serviceItemDataSelect)?e._i(e.serviceItemDataSelect,t)>-1:e.serviceItemDataSelect},on:{change:function(s){var a=e.serviceItemDataSelect,n=s.target,i=!!n.checked;if(Array.isArray(a)){var r=t,o=e._i(a,r);n.checked?o<0&&(e.serviceItemDataSelect=a.concat([r])):o>-1&&(e.serviceItemDataSelect=a.slice(0,o).concat(a.slice(o+1)))}else e.serviceItemDataSelect=i}}}),e._v("\n\t\t\t\t\t\t"+e._s(a+1)+"、"),s("label",{attrs:{for:a}},[e._v("其他")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.serviceItem,expression:"item.serviceItem"}],staticClass:"erpstore-input",attrs:{type:"text",placeHolder:"输入其他服务项",maxlength:"100"},domProps:{value:t.serviceItem},on:{input:function(s){s.target.composing||e.$set(t,"serviceItem",s.target.value)}}})])]})],2)]),e._v(" "),s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[e._v("预约上门时间：")]),e._v(" "),s("div",{staticClass:"controls"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.info.appointedStartTime,expression:"info.appointedStartTime"}],ref:"appointedStartTime",staticClass:"Wdate erpstore-input",attrs:{disabled:e.isDisabled,onclick:"WdatePicker({dateFmt:'yyyy-MM-dd HH:mm', isShowClear:true, readOnly:true});",type:"text"},domProps:{value:e.info.appointedStartTime},on:{focus:function(t){e.changeDate(t,"appointedStartTime")},input:function(t){t.target.composing||e.$set(e.info,"appointedStartTime",t.target.value)}}}),e._v("—\n\t\t\t\t"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.info.appointedEndTime,expression:"info.appointedEndTime"}],ref:"appointedEndTime",staticClass:"Wdate erpstore-input",attrs:{disabled:e.isDisabled,onclick:"WdatePicker({dateFmt:'yyyy-MM-dd HH:mm', isShowClear:true, readOnly:true});",type:"text"},domProps:{value:e.info.appointedEndTime},on:{focus:function(t){e.changeDate(t,"appointedEndTime")},input:function(t){t.target.composing||e.$set(e.info,"appointedEndTime",t.target.value)}}})])])])])},staticRenderFns:[]};var o=s("VU/8")(i,r,!1,function(e){s("s+37")},null,null);t.a=o.exports},oAV5:function(e,t,s){"use strict";s.d(t,"f",function(){return l}),s.d(t,"g",function(){return u}),s.d(t,"e",function(){return d}),s.d(t,"d",function(){return p}),s.d(t,"b",function(){return h}),s.d(t,"a",function(){return m});var a=s("//Fk"),n=s.n(a),i=s("mvHQ"),r=s.n(i),o=s("pFYg"),c=s.n(o),l=function(e,t,s){for(var a=0,n=t.length,i=!1;a<n;){if(e===t[a][s]){i=!0;break}a++}return i},u=function(e){return""+e.replace(/(^\s*)|(\s*$)/g,"")},d=function(){var e=new Date,t=e.getMonth()+1,s=e.getDate();return e.getFullYear()+"-"+(t>9?t:"0"+t)+"-"+(s>9?s:"0"+s)};f.prototype.getDateStr3=function(e){var t=e;return""+t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):""+(t.getMonth()+1))+"-"+(t.getDate()<10?"0"+t.getDate():""+t.getDate())},f.prototype.getWeekStartAndEnd=function(e){var t=new Date,s=(t=new Date(t.getTime()+6048e5*e)).getDay(),a=(t.getDate(),0!=s?s-1:6),n=new Date(t.getTime()-864e5*a),i=new Date(n.getTime()+5184e5);return this.getDateStr3(n)+" - "+this.getDateStr3(i)};var p=function(e,t,s){e=e;var a=t?new Date(t):new Date,n=a.getFullYear(),i=a.getMonth()+1,r=a.getDate();return r<=e&&(i>1?i-=1:(n-=1,i=12)),"before"===s?a.setDate(a.getDate()-e):a.setDate(a.getDate()+e),n=a.getFullYear(),i=a.getMonth()+1,r=a.getDate(),n+"-"+(i<10?"0"+i:i)+"-"+(r<10?"0"+r:r)};function f(e){this.date=e.date,this.type=e.type,this.value=void 0!==e.value?e.value:0,this.format=void 0!==e.format?e.format:"yyyy/MM/dd",this.date instanceof Date?(this.year=this.date.getFullYear(),this.month=this.date.getMonth()+1,this.day=this.date.getDate()):(this.year=this.date.substr(0,4),this.month=this.date.substr(5,2),this.day=this.date.substr(8,2))}f.prototype.beforeDate=function(e,t){var s=e||this.type,a=t||this.value,n=this.year,i=this.month,r=this.day;"year"===s||"年"===s?n-=a:"month"===s||"月"===s?(n-=parseInt(a/12),(i-=a%12)<=0&&(n-=1,i+=12)):"day"!==s&&"日"!==s||(r-=a%30)<=0&&(n-=1,i+=12);var o=new Date(n,i-1,r);return this.formatDate(o,this.format)},f.prototype.formatDate=function(e,t){var s={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),s)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?s[a]:("00"+s[a]).substr((""+s[a]).length)));return t},f.prototype.getThisMonth=function(){var e=new Date(this.year,this.month-1),t=new Date(this.year,this.month,0);return this.formatDate(e,this.format)+" - "+this.formatDate(t,this.format)},f.prototype.getSomeMonth=function(e){return this.beforeDate("month",e)+" - "+this.beforeDate("now",0)},f.prototype.getThisYear=function(){var e=new Date(this.year,0,1),t=new Date(this.year,11,31);return this.formatDate(e,this.format)+" - "+this.formatDate(t,this.format)},f.prototype.formatTimeStr=function(e){var t=new Date,s=parseInt(t.getTime()),a=new Date(t.getFullYear()+"/"+(t.getMonth()+1)+"/"+(t.getDate()-1)+" 00:00:01"),n=new Date(e),i=(s-e)/1e3;return i>=31536e3||n.getFullYear()!=t.getFullYear()?n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate():i>259200?n.getMonth()+1+"-"+n.getDate():n.getDate()==a.getDate()?"昨天":i>86400?Math.ceil(i/86400)+"天前":i>3600?Math.floor(i/3600)+"小时前":i>60?Math.floor(i/60)+"分钟前":"刚刚"};var h=new f({date:"2018-06-01",type:"month",value:"14",format:"yyyy-MM-dd hh:mm:ss"}),v=function(e){var t,s,a,n={url:location.href,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,xhr:function(){try{return new XMLHttpRequest}catch(e){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){return new ActiveXObject("Microsoft.XMLHTTP")}}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript, application/x-javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},i={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},r=(new Date).getTime(),o=/\[\]$/,l=/\=\?(&|$)/,u=/\?/,d=/%20/g,p=/\S/,f={},h={},v=function e(){var t,s,a,n,i,r,o=arguments[0]||{},l=arguments.length;for(t=1;t<l;++t)if(null!=(s=arguments[t]))for(r in s)a=o[r],n=s[r],o!==n&&("object"===(void 0===n?"undefined":c()(n))?(i=a&&"object"===(void 0===a?"undefined":c()(a))?a:{},o[r]=e(i,n)):void 0!==n&&(o[r]=n));return o}(n,e),m=v.type.toUpperCase(),g=/^(?:GET|HEAD)$/.test(m);if(v.url=v.url.replace(/#.*$/,""),v.context=e&&null!=e.context?e.context:v,v.data&&v.processData&&"string"!=typeof v.data&&(v.data=function(e){var t,s=[],a=function(e,t){t=N(t)?t():t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(A(e))for(t in e)a(t,e[t]);else for(var n in e)E(n,e[n],a);return s.join("&").replace(d,"+")}(v.data)),"jsonp"===v.dataType&&("GET"===m?l.test(v.url)||(v.url+=(u.test(v.url)?"&":"?")+(v.jsonp||"callback")+"=?"):v.data&&l.test(v.data)||(v.data=(v.data?v.data+"&":"")+(v.jsonp||"callback")+"=?"),v.dataType="json"),"json"===v.dataType&&(v.data&&l.test(v.data)||l.test(v.url))){t=v.jsonpCallback||"jsonp"+r++,v.data&&(v.data=(v.data+"").replace(l,"="+t+"$1")),v.url=v.url.replace(l,"="+t+"$1"),v.dataType="script";var y=window[t];window[t]=function(e){if(N(y))y(e);else{window[t]=void 0;try{delete window[t]}catch(e){}}M(v,D,s,a=e),F(v,D,s),w&&w.removeChild(S)}}v.data&&g&&(v.url+=(u.test(v.url)?"&":"?")+v.data);var x=/^(\w+:)?\/\/([^\/?#]+)/.exec(v.url),b=x&&(x[1]&&x[1].toLowerCase()!==location.protocol||x[2].toLowerCase()!==location.host);if("script"===v.dataType&&"GET"===m&&b){var w=document.getElementsByTagName("head")[0]||document.documentElement,S=document.createElement("script");if(v.scriptCharset&&(S.charset=v.scriptCharset),S.src=v.url,!t){var I=!1;S.onload=S.onreadystatechange=function(){I||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(I=!0,M(v,D,s,a),F(v,D,s),S.onload=S.onreadystatechange=null,w&&S.parentNode&&w.removeChild(S))}}w.insertBefore(S,w.firstChild)}else{var C=!1,D=v.xhr();if(D){v.username?D.open(m,v.url,v.async,v.username,v.password):D.open(m,v.url,v.async),v.withCredentials&&"withCredentials"in D&&(D.withCredentials=!0);try{(null!=v.data&&!g||e&&e.contentType)&&D.setRequestHeader("Content-Type",v.contentType),v.ifModified&&(f[v.url]&&D.setRequestHeader("If-Modified-Since",f[v.url]),h[v.url]&&D.setRequestHeader("If-None-Match",h[v.url])),b||D.setRequestHeader("X-Requested-With","XMLHttpRequest"),D.setRequestHeader("Accept",v.dataType&&v.accepts[v.dataType]?v.accepts[v.dataType]+", */*; q=0.01":v.accepts._default)}catch(e){}if(v.beforeSend&&!1===v.beforeSend.call(v.context,D,v))return D.abort(),!1;var _=D.onreadystatechange=function(e){if(D&&0!==D.readyState&&"abort"!==e){if(!C&&D&&(4===D.readyState||"timeout"===e)){var n;if(C=!0,D.onreadystatechange=j,"success"===(s="timeout"===e?"timeout":function(e){try{return!e.status&&"file:"===location.protocol||e.status>=200&&e.status<300||304===e.status||1223===e.status}catch(e){}return!1}(D)?v.ifModified&&function(e,t){var s=e.getResponseHeader("Last-Modified"),a=e.getResponseHeader("Etag");s&&(s[t]=s);a&&(a[t]=a);return 304===e.status}(D,v.url)?"notmodified":"success":"error"))try{a=function(e,t,s){var a=e.getResponseHeader("content-type")||"",n="xml"===t||!t&&a.indexOf("xml")>=0,i=n?e.responseXML:e.responseText;if(n&&"parsererror"===i.documentElement.nodeName)throw"parsererror";s&&s.dataFilter&&(i=s.dataFilter(i,t));"string"==typeof i&&("json"===t||!t&&a.indexOf("json")>=0?i=JSON.parse(i):("script"===t||!t&&a.indexOf("javascript")>=0)&&function(e){if(e&&p.test(e)){var t=document.getElementsByTagName("head")[0]||document.documentElement,s=document.createElement("script");s.type="text/javascript",scriptEval?s.appendChild(document.createTextNode(e)):s.text=e,t.insertBefore(s,t.firstChild),t.removeChild(s)}}(i));return i}(D,v.dataType,v)}catch(e){s="parsererror",n=e}"success"===s||"notmodified"===s?t||M(v,D,s,a):P(v,D,s,n),t||F(v,D,s),"timeout"===e&&D.abort(),v.async&&(D=null)}}else C||F(v,D,s),C=!0,D&&(D.onreadystatechange=j)};try{var T=D.abort;D.abort=function(){D&&Function.prototype.call.call(T,D),_("abort")}}catch(e){}v.async&&v.timeout>0&&setTimeout(function(){D&&!C&&_("timeout")},v.timeout);try{D.send(g||null==v.data?null:v.data)}catch(e){P(v,D,null,e),F(v,D,s)}return v.async||_(),D}}function k(e){return null==e?String(e):i[toString.call(e)]||"object"}function N(e){return"function"===k(e)}function A(e){return"array"===k(e)}function E(e,t,s){if(A(t)&&t.length)for(var a in t){var n=t[a];o.test(e)?s(e,n):E(e+"["+("object"===(void 0===n?"undefined":c()(n))||A(n)?a:"")+"]",n,s)}else if(null!=t&&"object"===(void 0===t?"undefined":c()(t)))if(function(e){for(var t in e)return!1;return!0}(t))s(e,"");else for(var i in t){E(e+"["+i+"]",n=t[i],s)}else s(e,t)}function P(e,t,s,a){"function"==typeof e.error&&e.error.call(e.context,t,s,a)}function M(e,t,s,a){"function"==typeof e.success&&e.success.call(e.context,a,s,t)}function F(e,t,s){"function"==typeof e.complete&&e.complete.call(e.context,t,s)}function j(){}},m=function(e){var t,s,a=e.data;return"string"==typeof e.dataType&&"string"==typeof e.type&&"json"===(t=e.dataType.toLowerCase())&&"post"===e.type.toLowerCase()&&(a=r()(e.data)),"string"==typeof e.contentType&&(s=e.contentType.toLowerCase()),new n.a(function(n,i){v({url:e.url||"url",type:e.type||"GET",async:!1!==e.async,withCredentials:e.withCredentials,data:a,dataType:t||"default",contentType:s||"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:function(){return"function"!=typeof e.beforeSend||e.beforeSend()},success:function(e,t,s,a){n(e,t,s,a)},error:function(e,t,s,a){i({responseText:e.responseText,code:e.status})},complete:function(e,t,s){n(e,t,s)}})})};t.c=f},"s+37":function(e,t){}},["J2l+"]);