webpackJsonp([68],{"+jcF":function(t,e){},BD2p:function(t,e,s){"use strict";var n=s("bOdI"),i=s.n(n),r={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return"ivu-icon ivu-icon-"+this.type},styles:function(){var t={};return this.size&&(t["font-size"]=this.size+"px"),this.color&&(t.color=this.color),t}}},a={render:function(){var t=this.$createElement;return(this._self._c||t)("i",{class:this.classes,style:this.styles})},staticRenderFns:[]},o=s("VU/8")(r,a,!1,null,null,null).exports,l=(s("BO1k"),s("7+uW").default.prototype.$isServer);function c(t,e){for(var s=0;s<e.length;s++)if(t===e[s])return!0;return!1}!l&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver);var u={components:{Icon:o},props:{percent:{type:Number,default:0},status:{validator:function(t){return c(t,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1}},data:function(){return{currentStatus:this.status}},computed:{isStatus:function(){return"wrong"==this.currentStatus||"success"==this.currentStatus},statusIcon:function(){var t="";switch(this.currentStatus){case"wrong":t="ios-close";break;case"success":t="ios-checkmark"}return t},bgStyle:function(){return this.vertical?{height:this.percent+"%",width:this.strokeWidth+"px"}:{width:this.percent+"%",height:this.strokeWidth+"px"}},wrapClasses:function(){var t;return["ivu-progress","ivu-progress-"+this.currentStatus,(t={},i()(t,"ivu-progress-show-info",!this.hideInfo),i()(t,"ivu-progress-vertical",this.vertical),t)]},textClasses:function(){return"ivu-progress-text"},textInnerClasses:function(){return"ivu-progress-text-inner"},outerClasses:function(){return"ivu-progress-outer"},innerClasses:function(){return"ivu-progress-inner"},bgClasses:function(){return"ivu-progress-bg"}},created:function(){this.handleStatus()},methods:{handleStatus:function(t){t?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100==parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent:function(t,e){t<e?this.handleStatus(!0):this.handleStatus()},status:function(t){this.currentStatus=t}}},d={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.wrapClasses},[s("div",{class:t.outerClasses},[s("div",{class:t.innerClasses},[s("div",{class:t.bgClasses,style:t.bgStyle})])]),t._v(" "),t.hideInfo?t._e():s("span",{class:t.textClasses},[t._t("default",[t.isStatus?s("span",{class:t.textInnerClasses},[s("Icon",{attrs:{type:t.statusIcon}})],1):s("span",{class:t.textInnerClasses},[t._v("\n                "+t._s(t.percent)+"%\n            ")])])],2)])},staticRenderFns:[]},p={name:"UploadList",components:{Icon:o,iProgress:s("VU/8")(u,d,!1,null,null,null).exports},props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(t){return["ivu-upload-list-file",i()({},"ivu-upload-list-file-finish","finished"===t.status)]},handleClick:function(t){this.$emit("on-file-click",t)},handlePreview:function(t){this.$emit("on-file-preview",t)},handleRemove:function(t){this.$emit("on-file-remove",t)},format:function(t){var e=t.name.split(".").pop().toLocaleLowerCase()||"",s="document";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(e)>-1&&(s="image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(e)>-1&&(s="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(e)>-1&&(s="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(e)>-1&&(s="document-text"),["numbers","csv","xls","xlsx"].indexOf(e)>-1&&(s="stats-bars"),["keynote","ppt","pptx"].indexOf(e)>-1&&(s="ios-videocam"),s},parsePercentage:function(t){return parseInt(t,10)}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{class:[t.prefixCls+"-list"]},t._l(t.files,function(e){return s("li",{class:t.fileCls(e),on:{click:function(s){t.handleClick(e)}}},[s("span",{on:{click:function(s){t.handlePreview(e)}}},[s("Icon",{attrs:{type:t.format(e)}}),t._v(" "+t._s(e.name)+"\n        ")],1),t._v(" "),s("Icon",{directives:[{name:"show",rawName:"v-show",value:"finished"===e.status,expression:"file.status === 'finished'"}],class:[t.prefixCls+"-list-remove"],attrs:{type:"ios-close-empty"},nativeOn:{click:function(s){t.handleRemove(e)}}}),t._v(" "),s("transition",{attrs:{name:"fade"}},[e.showProgress?s("i-progress",{attrs:{"stroke-width":2,percent:t.parsePercentage(e.percentage),status:"finished"===e.status&&e.showProgress?"success":"normal"}}):t._e()],1)],1)}))},staticRenderFns:[]},f=s("VU/8")(p,h,!1,null,null,null).exports,v=s("fZjL"),m=s.n(v);function g(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function _(t){if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest,s=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var n=new FormData;t.data&&m()(t.data).map(function(e){n.append(e,t.data[e])}),n.append(t.filename,t.file),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,s){var n="fail to post "+t+" "+s.status+"'",i=new Error(n);return i.status=s.status,i.method="post",i.url=t,i}(s,0,e),g(e));t.onSuccess(g(e))},e.open("post",s,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var i=t.headers||{};for(var r in i)i.hasOwnProperty(r)&&null!==i[r]&&e.setRequestHeader(r,i[r]);e.send(n)}}var y={name:"Upload",mixins:[{methods:{dispatch:function(t,e,s){for(var n=this.$parent||this.$root,i=n.$options.name;n&&(!i||i!==t);)(n=n.$parent)&&(i=n.$options.name);n&&n.$emit.apply(n,[e].concat(s))},broadcast:function(t,e,s){(function t(e,s,n){this.$children.forEach(function(i){i.$options.name===e?i.$emit.apply(i,[s].concat(n)):t.apply(i,[e,s].concat([n]))})}).call(this,t,e,s)}}}],components:{UploadList:f},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(t){return c(t,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},maxSelectNum:{type:Number},existNum:{type:Number},index:{type:Number}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var t;return["ivu-upload",(t={},i()(t,"ivu-upload-select","select"===this.type),i()(t,"ivu-upload-drag","drag"===this.type),i()(t,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),t)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(t){var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},onDrop:function(t){this.dragOver=!1,this.uploadFiles(t.dataTransfer.files)},uploadFiles:function(t){var e=this,s=Array.prototype.slice.call(t);if(this.maxSelectNum&&s.length>this.maxSelectNum-this.existNum)return erpShopApp.tip("最多只能上传"+this.maxSelectNum+"张图片！","info"),!1;this.multiple||(s=s.slice(0,1)),0!==s.length&&s.forEach(function(t){e.upload(t)})},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);var s=this.beforeUpload(t,this.index);s&&s.then?s.then(function(s){"[object File]"===Object.prototype.toString.call(s)?e.post(s):e.post(t)},function(){}):!1!==s&&this.post(t)},post:function(t){var e=this;if(this.format.length){var s=t.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(t){return t.toLocaleLowerCase()===s}))return this.onFormatError(t,this.fileList),!1}if(this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),(new FormData).append(this.name,t),_({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(s){e.handleProgress(s,t)},onSuccess:function(s){e.handleSuccess(s,t,e.index)},onError:function(s,n){e.handleError(s,n,t)}})},handleStart:function(t){t.uid=Date.now()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e)},getFile:function(t){var e=void 0;return this.fileList.every(function(s){return!(e=t.uid===s.uid?s:null)}),e},handleProgress:function(t,e){var s=this.getFile(e);this.onProgress(t,s,this.fileList),s.percentage=t.percent||0},handleSuccess:function(t,e,s){var n=this.getFile(e);n&&(n.status="finished",n.response=t,this.dispatch("FormItem","on-form-change",n),this.onSuccess(t,n,this.fileList,s),setTimeout(function(){n.showProgress=!1},1e3))},handleError:function(t,e,s){var n=this.getFile(s),i=this.fileList;n.status="fail",i.splice(i.indexOf(n),1),this.onError(t,e,s)},handleRemove:function(t){var e=this.fileList;e.splice(e.indexOf(t),1),this.onRemove(t,e)},handlePreview:function(t){"finished"===t.status&&this.onPreview(t)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(t){var e=this;this.fileList=t.map(function(t){return t.status="finished",t.percentage=100,t.uid=Date.now()+e.tempIndex++,t})}}}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:[t.prefixCls]},[s("div",{class:t.classes,on:{click:t.handleClick,drop:function(e){e.preventDefault(),t.onDrop(e)},dragover:function(e){e.preventDefault(),t.dragOver=!0},dragleave:function(e){e.preventDefault(),t.dragOver=!1}}},[s("input",{ref:"input",class:[t.prefixCls+"-input"],attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}}),t._v(" "),t._t("default")],2),t._v(" "),t._t("tip"),t._v(" "),t.showUploadList?s("upload-list",{attrs:{files:t.fileList},on:{"on-file-remove":t.handleRemove,"on-file-preview":t.handlePreview}}):t._e()],2)},staticRenderFns:[]},b=s("VU/8")(y,w,!1,null,null,null);e.a=b.exports},VfXf:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("Dd8w"),i=s.n(n),r=s("7+uW"),a=s("woOf"),o=s.n(a),l=s("mtWM"),c=s.n(l),u=s("BD2p"),d={props:["orderId","procInsId","shopNeedsPicture","auditStatus"],data:function(){return{reason:""}},components:{},methods:{closeModal:function(){this.$emit("closeModalByEnter")},saveData:function(){var t={auditResult:"Return",orderId:this.orderId,procInsId:this.procInsId,reason:this.reason},e="";"0"===this.auditStatus?(o()(t,{verifyInfo:this.shopNeedsPicture.join(";")}),e=ctx+"/order/flow/order_review_first"):"1"===this.auditStatus&&(e=ctx+"/order/flow/order_review_second"),c.a.get(e,{params:t}).then(function(t){t.data.result?(erpShopApp.tip("审核不通过!","error"),jQuery("#mainFrame",top.window.document)[0].contentWindow.location.reload(),window.parent.jQuery(".jbox-body").remove()):erpShopApp.tip(t.data.message,"error")})}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mask-widget-entry"},[s("div",{staticClass:"header-content"},[t._v("确定审核不通过?")]),t._v(" "),s("div",{staticClass:"form-horizontal clearboth erpstore-horizontal"},[s("div",{staticClass:"control-group"},[s("label",{staticClass:"control-label"},[t._v("请输入修改建议：")]),t._v(" "),s("div",{staticClass:"controls"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reason,expression:"reason"}],staticClass:"erpstore-input",staticStyle:{height:"80px",width:"288px"},domProps:{value:t.reason},on:{input:function(e){e.target.composing||(t.reason=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"button-content"},[s("button",{staticClass:"btn btn-outline",attrs:{type:"button"},on:{click:t.closeModal}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.saveData}},[t._v("确定不通过")])]),t._v(" "),s("div",{staticClass:"close",on:{click:t.closeModal}},[t._v("×")])])},staticRenderFns:[]};var h=s("VU/8")(d,p,!1,function(t){s("tWec")},null,null).exports,f={data:function(){return{uploadAction:ctx+"/diagnosis/diagnosisForm/upload",shopNeedsPicture:[],uploadUrl:pageDataObject.uploadfileurl||apiurl.uploadUrl,entryFlag:!1,orderId:erpShopApp.getQueryString("orderId",location.href),auditStatus:erpShopApp.getQueryString("auditStatus",location.href),orderObj:{}}},components:{Upload:u.a,EntryModel:h},mounted:function(){this.getData()},methods:{closeModal:function(){this.$emit("closeModalByRedeploy")},getData:function(){var t=this;c.a.get(ctx+"/order/erpOrderOriginalInfo/getOrderAndGood?orderId="+this.orderId).then(function(e){e.data&&e.data.hasOwnProperty("order")&&(t.orderObj=e.data.order,e.data.verifyInfo&&(t.shopNeedsPicture=e.data.verifyInfo.split(";")))})},consentFun:function(){if(0!==this.shopNeedsPicture.length){var t={auditResult:"Pass",orderId:this.orderId,procInsId:this.orderObj.procInsId},e="";"0"===this.auditStatus?(o()(t,{verifyInfo:this.shopNeedsPicture.join(";")}),e=ctx+"/order/flow/order_review_first"):"1"===this.auditStatus&&(e=ctx+"/order/flow/order_review_second"),c.a.get(e,{params:t}).then(function(t){t.data.result&&(erpShopApp.tip("审核成功!","info"),jQuery("#mainFrame",top.window.document)[0].contentWindow.location.reload(),window.parent.jQuery(".jbox-body").remove())})}else erpShopApp.tip("必须上传订单核实信息!","error")},handleBefore:function(){return 5!==this.shopNeedsPicture.length||(erpShopApp.tip("最多只能上传5张图片！","info"),!1)},handleMaxSize:function(t){erpShopApp.tip("文件 "+t.name+" 太大，不能超过 50M。","info")},handleFormatError:function(t){erpShopApp.tip("文件 "+t.name+" 格式不正确，请上传 jpg 或 png 格式的图片。","info")},handleSuccess:function(t,e){"0"===t.code?this.shopNeedsPicture.push(t.attach):erpShopApp.tip("文件上传失败！","info")},deleteImg:function(t){this.shopNeedsPicture.splice(t,1)},showNaturePics:function(t,e){var s=this.$refs[t],n={title:"查看大图",width:s.naturalWidth||window.innerWidth,height:s.naturalHeight||window.innerHeight,opacity:0,buttons:null,text:'<img src="'+e+'" alt="大图" />'};erpShopApp.showDialog(n)}},watch:{}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"mask-widget-audit"},[s("div",{staticClass:"form-horizontal clearboth erpstore-horizontal"},[s("div",{staticClass:"order-content-big"},[s("div",{staticClass:"order-header-title"},[t._v("订单基本信息")]),t._v(" "),s("div",{staticClass:"order-info-content"},[s("p",[s("span",[t._v("订单号：")]),t._v(" "),s("span",{staticClass:"depart-show"},[t._v(t._s(t.orderObj.orderNumber))]),t._v(" "),1===t.orderObj.orderType?s("span",[t._v("订单类别：直销")]):s("span",[t._v("订单类别：服务商")])]),t._v(" "),s("p",[s("span",[t._v("购买时间：")]),t._v(" "),s("span",{staticClass:"depart-show"},[t._v(t._s(t.orderObj.buyDate))]),t._v(" "),s("span",[t._v("录单时间："+t._s(t.orderObj.createAt))])]),t._v(" "),s("div",{staticClass:"div-line"}),t._v(" "),s("p",[s("span",[t._v("商户名称：")]),t._v(" "),s("span",{staticClass:"depart-show"},[t._v(t._s(t.orderObj.shopName))])]),t._v(" "),s("p",[s("span",[t._v("商户联系人：")]),t._v(" "),s("span",{staticClass:"depart-show"},[t._v(t._s(t.orderObj.contactName))]),t._v(" "),s("span",[t._v("商户联系人电话："+t._s(t.orderObj.contactNumber))])]),t._v(" "),s("div",{staticClass:"div-line"}),t._v(" "),s("p",[s("span",[t._v("服务商名称：")]),t._v(" "),s("span",{staticClass:"depart-show-by"},[t._v(t._s(t.orderObj.agentName))])]),t._v(" "),s("div",{staticClass:"div-line"}),t._v(" "),s("p",[s("span",[t._v("订单创建人：")]),t._v(" "),s("span",{staticClass:"depart-show"},[t._v(t._s(t.orderObj.createByName))])])])]),t._v(" "),s("div",{staticClass:"order-content-big",staticStyle:{"margin-top":"15px"}},[s("div",{staticClass:"order-header-title"},[t._v("备注")]),t._v(" "),s("div",{staticClass:"order-info-content"},[s("p",[s("span",[t._v(t._s(t.orderObj.remark))])])])]),t._v(" "),s("div",{staticClass:"order-content-big",staticStyle:{"margin-top":"15px"}},[s("div",{staticClass:"order-header-title"},[t._v("购买的商品")]),t._v(" "),s("div",{staticClass:"order-info-content"},[s("p",[s("table",{staticClass:"table table-striped table-bordered table-condensed"},[t._m(0),t._v(" "),s("tbody",t._l(t.orderObj.erpOrderOriginalGoods,function(e){return s("tr",[s("td",[t._v(t._s(e.goodName))]),t._v(" "),s("td",[t._v(t._s(e.goodTypeName))]),t._v(" "),s("td",[t._v(t._s(e.realPrice))]),t._v(" "),s("td",[t._v(t._s(e.num))])])}))])])])]),t._v(" "),s("div",{staticClass:"order-content-big",staticStyle:{"margin-top":"15px",overflow:"hidden","padding-bottom":"15px"}},[s("div",{staticClass:"order-header-title"},[t._v("上传订单核实信息")]),t._v(" "),s("div",{staticClass:"order-info-content"},[s("p"),t._l(t.shopNeedsPicture,function(e,n){return s("div",{staticClass:"img-content"},[s("div",[s("a",{attrs:{href:"javascript:;"},on:{click:function(s){t.showNaturePics("img-big"+n,t.uploadUrl+"/"+e)}}},[s("img",{ref:"img-big"+n,refInFor:!0,attrs:{src:t.uploadUrl+"/"+e}})])]),t._v(" "),s("div",["0"===t.auditStatus?s("button",{staticClass:"ios-trash-outline",on:{click:function(e){t.deleteImg(n)}}},[t._v("删除")]):t._e()])])}),t._v(" "),"0"===t.auditStatus?s("upload",{ref:"audit",staticStyle:{display:"inline-block",width:"76px",float:"left"},attrs:{type:"drag","on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,format:["jpg","jpeg","png","gif"],accept:"image/*","max-size":51200,"before-upload":t.handleBefore,action:t.uploadAction}},[s("div",{staticStyle:{width:"76px",height:"76px","line-height":"76px","text-align":"center"}},[s("span",[s("i",{staticClass:"icon-camera"}),t._v("上传")])])]):t._e(),t._v(" "),s("p")],2)])]),t._v(" "),s("div",{staticClass:"button-content"},[s("button",{staticClass:"btn btn-outline",attrs:{type:"button"},on:{click:function(e){t.entryFlag=!0}}},[t._v("不通过")]),t._v(" "),s("button",{staticClass:"btn btn-primary",staticStyle:{"margin-left":"15px"},attrs:{type:"button"},on:{click:t.consentFun}},[t._v("通过")])]),t._v(" "),s("entry-model",{directives:[{name:"show",rawName:"v-show",value:t.entryFlag,expression:"entryFlag"}],attrs:{auditStatus:t.auditStatus,orderId:t.orderId,shopNeedsPicture:t.shopNeedsPicture,procInsId:t.orderObj.procInsId},on:{closeModalByEnter:function(e){t.entryFlag=!1}}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[e("div",{staticClass:"th"},[this._v("商品名称")])]),this._v(" "),e("th",[e("div",{staticClass:"th"},[this._v("业务类型")])]),this._v(" "),e("th",[e("div",{staticClass:"th"},[this._v("价格")])]),this._v(" "),e("th",[e("div",{staticClass:"th"},[this._v("数量")])])])])}]};var m=s("VU/8")(f,v,!1,function(t){s("+jcF")},null,null).exports;r.default.config.productionTip=!1,r.default.config.devtools=!1,new r.default(i()({},m)).$mount("#rootNode")},tWec:function(t,e){}},["VfXf"]);