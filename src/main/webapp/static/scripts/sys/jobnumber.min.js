webpackJsonp([31],{2257:function(t,e){},"a4+S":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),o=a("7+uW"),s=a("mtWM"),i=a.n(s),c=a("xVHK"),l=a("i84Q"),u={data:function(){return{jobnumberData:{id:"",isNewRecord:!1,jobNumber:"",roleId:"",roleName:"",userId:"",userName:"",telephone:"",score:"0",iconImg:""},roleData:[],userData:[],imgUri:pageDataObject.uploadfileurl+"/",iconImgs:[],id:erpApp.getQueryString("id",location.href),showMoreState:!1}},components:{AvatarList:c.a},computed:{resDatas:function(){return this.resData},roleDatas:function(){return this.roleData},userDatas:function(){return this.userData},jobnumberDatas:function(){return this.jobnumberData}},mounted:function(){this.getData()},methods:{getData:function(){var t=this,e="";this.showMoreState=!1,i.a.get(ctx+"/sys/jobNumber/getData?id="+this.id).then(function(a){"0"===a.data.code&&(t.jobnumberData=erpApp.extend(!0,t.jobnumberData,a.data.attach));try{e=a.data.attach.iconImg}catch(t){}Object(l.a)().then(function(a){if(Array.isArray(a)){var r=a.indexOf(e);if(e&&-1!==r){var n=a.splice(r,1).concat(a);t.jobnumberData.iconImg=e,t.iconImgs=n}else t.iconImgs=a}})}),this.getRoleData()},getRoleData:function(){var t=this;i.a.get(ctx+"/sys/jobNumber/getRoleData").then(function(e){"0"===e.data.code&&(t.roleData=e.data.attach)})},changeroleName:function(){var t=this;setTimeout(function(){for(var e=0,a=t.roleDatas.length;e<a;e++)if(t.roleDatas[e].name===t.jobnumberData.roleName){t.jobnumberData.roleId=t.roleDatas[e].id;break}},20)},selectUser:function(){var t=this;if(this.id&&"undefined"!==this.id&&"null"!==this.id)return erpApp.tip("人员信息不能修改！"),!1;erpApp.selectUser(!0,null,600,function(e){t.jobnumberData.userId="",t.jobnumberData.userName="",e.forEach(function(e,a){t.jobnumberData.userId+=e.user.split(",")[0]+",",t.jobnumberData.userName+=e.user.split(",")[1]+","}),t.jobnumberData.userId.replace(/(^,*)/g,"").replace(/(,*$)/g,""),t.jobnumberData.userName.replace(/(^,*)/g,"").replace(/(,*$)/g,"")})},changeIconImg:function(t){this.jobnumberData.iconImg=t}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"jobnumber"},[t._m(0),t._v(" "),a("div",{staticClass:"form-horizontal clearboth erpstore-horizontal",staticStyle:{"margin-top":"15px"}},[a("div",{staticClass:"control-group"},[a("label",{staticClass:"control-label"},[t._v("选择头像：")]),t._v(" "),a("div",{staticClass:"controls"},[a("avatar-list",{attrs:{list:t.iconImgs,selectedAvatar:t.jobnumberDatas.iconImg,showMoreState:t.showMoreState,imgUri:t.imgUri},on:{select:t.changeIconImg}})],1)]),t._v(" "),a("div",{staticClass:"control-group"},[a("label",{staticClass:"control-label"},[t._v("工号：")]),t._v(" "),a("div",{staticClass:"controls"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.jobnumberDatas.jobNumber,expression:"jobnumberDatas.jobNumber",modifiers:{trim:!0}}],staticClass:"erpstore-input",staticStyle:{width:"255px"},attrs:{type:"text"},domProps:{value:t.jobnumberDatas.jobNumber},on:{input:function(e){e.target.composing||t.$set(t.jobnumberDatas,"jobNumber",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),a("div",{staticClass:"control-group"},[a("label",{staticClass:"control-label"},[t._v("角色：")]),t._v(" "),a("div",{staticClass:"controls"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.jobnumberDatas.roleName,expression:"jobnumberDatas.roleName"}],ref:"roleName",staticClass:"erpstore-select",staticStyle:{width:"270px"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.jobnumberDatas,"roleName",e.target.multiple?a:a[0])},t.changeroleName]}},t._l(t.roleDatas,function(e,r){return a("option",{key:"roleData"+r,attrs:{label:e.name},domProps:{value:e.name,selected:t.jobnumberDatas.roleName===e.name}},[t._v("\n\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t")])})),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.jobnumberDatas.roleName,expression:"jobnumberDatas.roleName"}],staticClass:"erpstore-input",attrs:{type:"hidden"},domProps:{value:t.jobnumberDatas.roleName},on:{input:function(e){e.target.composing||t.$set(t.jobnumberDatas,"roleName",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"control-group"},[a("label",{staticClass:"control-label"},[t._v("人员：")]),t._v(" "),a("div",{staticClass:"controls"},[a("div",{staticClass:"input-append"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.jobnumberDatas.userName,expression:"jobnumberDatas.userName",modifiers:{trim:!0}}],staticClass:"erpstore-input",attrs:{readonly:"readonly",type:"text"},domProps:{value:t.jobnumberDatas.userName},on:{input:function(e){e.target.composing||t.$set(t.jobnumberDatas,"userName",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),a("a",{staticClass:"btn",attrs:{id:"userNameButton",href:"javascript:"},on:{click:t.selectUser}},[t._v(" "),a("i",{staticClass:"icon-search"}),t._v(" ")])])])]),t._v(" "),a("div",{staticClass:"control-group"},[a("label",{staticClass:"control-label"},[t._v("电话：")]),t._v(" "),a("div",{staticClass:"controls"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.jobnumberDatas.telephone,expression:"jobnumberDatas.telephone",modifiers:{trim:!0}}],staticClass:"erpstore-input",staticStyle:{width:"255px"},attrs:{type:"text"},domProps:{value:t.jobnumberDatas.telephone},on:{input:function(e){e.target.composing||t.$set(t.jobnumberDatas,"telephone",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),t._v(" "),a("div",{staticClass:"control-group"},[a("label",{staticClass:"control-label"},[t._v("评分：")]),t._v(" "),a("div",{staticClass:"controls"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.jobnumberDatas.score,expression:"jobnumberDatas.score"}],ref:"score",staticClass:"erpstore-select",staticStyle:{width:"270px"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.jobnumberDatas,"score",e.target.multiple?a:a[0])}}},t._l(["0","1","2","3","4","5"],function(e,r){return a("option",{key:"score"+r,attrs:{label:e},domProps:{value:e,selected:t.jobnumberDatas.score===e}},[t._v("\n\t\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t\t")])}))])])]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:JSON.stringify(t.jobnumberDatas),expression:"JSON.stringify(jobnumberDatas)"}],attrs:{type:"hidden",id:"formDataInput",name:"formDataInput"},domProps:{value:JSON.stringify(t.jobnumberDatas)},on:{input:function(e){e.target.composing||t.$set(JSON,"stringify(jobnumberDatas)",e.target.value)}}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("p",{staticStyle:{"padding-left":"105px","line-height":"40px",color:"#e30"}},[this._v("提示：以下各项都是必填项")])])}]},p=a("VU/8")(u,d,!1,null,null,null).exports;o.default.config.productionTip=!1,o.default.config.devtools=!1,new o.default(n()({},p)).$mount("#rootNode")},i84Q:function(t,e,a){"use strict";e.a=function(){return new n.a(function(t,e){Object(o.a)({url:ctx+"/sys/user/getAvatarList"}).then(function(e,a,r,n){e=JSON.parse(e),t(e,a,r,n)}).catch(function(t){e(t.responseText,t.code)})})};var r=a("//Fk"),n=a.n(r),o=a("oAV5")},oAV5:function(t,e,a){"use strict";a.d(e,"f",function(){return l}),a.d(e,"g",function(){return u}),a.d(e,"e",function(){return d}),a.d(e,"d",function(){return p}),a.d(e,"b",function(){return f}),a.d(e,"a",function(){return v});var r=a("//Fk"),n=a.n(r),o=a("mvHQ"),s=a.n(o),i=a("pFYg"),c=a.n(i),l=function(t,e,a){for(var r=0,n=e.length,o=!1;r<n;){if(t===e[r][a]){o=!0;break}r++}return o},u=function(t){return""+t.replace(/(^\s*)|(\s*$)/g,"")},d=function(){var t=new Date,e=t.getMonth()+1,a=t.getDate();return t.getFullYear()+"-"+(e>9?e:"0"+e)+"-"+(a>9?a:"0"+a)};m.prototype.getDateStr3=function(t){var e=t;return""+e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):""+(e.getMonth()+1))+"-"+(e.getDate()<10?"0"+e.getDate():""+e.getDate())},m.prototype.getWeekStartAndEnd=function(t){var e=new Date,a=(e=new Date(e.getTime()+6048e5*t)).getDay(),r=(e.getDate(),0!=a?a-1:6),n=new Date(e.getTime()-864e5*r),o=new Date(n.getTime()+5184e5);return this.getDateStr3(n)+" - "+this.getDateStr3(o)};var p=function(t,e,a){t=t;var r=e?new Date(e):new Date,n=r.getFullYear(),o=r.getMonth()+1,s=r.getDate();return s<=t&&(o>1?o-=1:(n-=1,o=12)),"before"===a?r.setDate(r.getDate()-t):r.setDate(r.getDate()+t),n=r.getFullYear(),o=r.getMonth()+1,s=r.getDate(),n+"-"+(o<10?"0"+o:o)+"-"+(s<10?"0"+s:s)};function m(t){this.date=t.date,this.type=t.type,this.value=void 0!==t.value?t.value:0,this.format=void 0!==t.format?t.format:"yyyy/MM/dd",this.date instanceof Date?(this.year=this.date.getFullYear(),this.month=this.date.getMonth()+1,this.day=this.date.getDate()):(this.year=this.date.substr(0,4),this.month=this.date.substr(5,2),this.day=this.date.substr(8,2))}m.prototype.beforeDate=function(t,e){var a=t||this.type,r=e||this.value,n=this.year,o=this.month,s=this.day;"year"===a||"年"===a?n-=r:"month"===a||"月"===a?(n-=parseInt(r/12),(o-=r%12)<=0&&(n-=1,o+=12)):"day"!==a&&"日"!==a||(s-=r%30)<=0&&(n-=1,o+=12);var i=new Date(n,o-1,s);return this.formatDate(i,this.format)},m.prototype.formatDate=function(t,e){var a={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[r]:("00"+a[r]).substr((""+a[r]).length)));return e},m.prototype.getThisMonth=function(){var t=new Date(this.year,this.month-1),e=new Date(this.year,this.month,0);return this.formatDate(t,this.format)+" - "+this.formatDate(e,this.format)},m.prototype.getSomeMonth=function(t){return this.beforeDate("month",t)+" - "+this.beforeDate("now",0)},m.prototype.getThisYear=function(){var t=new Date(this.year,0,1),e=new Date(this.year,11,31);return this.formatDate(t,this.format)+" - "+this.formatDate(e,this.format)},m.prototype.formatTimeStr=function(t){var e=new Date,a=parseInt(e.getTime()),r=new Date(e.getFullYear()+"/"+(e.getMonth()+1)+"/"+(e.getDate()-1)+" 00:00:01"),n=new Date(t),o=(a-t)/1e3;return o>=31536e3||n.getFullYear()!=e.getFullYear()?n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate():o>259200?n.getMonth()+1+"-"+n.getDate():n.getDate()==r.getDate()?"昨天":o>86400?Math.ceil(o/86400)+"天前":o>3600?Math.floor(o/3600)+"小时前":o>60?Math.floor(o/60)+"分钟前":"刚刚"};var f=new m({date:"2018-06-01",type:"month",value:"14",format:"yyyy-MM-dd hh:mm:ss"}),h=function(t){var e,a,r,n={url:location.href,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,xhr:function(){try{return new XMLHttpRequest}catch(t){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){return new ActiveXObject("Microsoft.XMLHTTP")}}},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript, application/x-javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},o={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},s=(new Date).getTime(),i=/\[\]$/,l=/\=\?(&|$)/,u=/\?/,d=/%20/g,p=/\S/,m={},f={},h=function t(){var e,a,r,n,o,s,i=arguments[0]||{},l=arguments.length;for(e=1;e<l;++e)if(null!=(a=arguments[e]))for(s in a)r=i[s],n=a[s],i!==n&&("object"===(void 0===n?"undefined":c()(n))?(o=r&&"object"===(void 0===r?"undefined":c()(r))?r:{},i[s]=t(o,n)):void 0!==n&&(i[s]=n));return i}(n,t),v=h.type.toUpperCase(),b=/^(?:GET|HEAD)$/.test(v);if(h.url=h.url.replace(/#.*$/,""),h.context=t&&null!=t.context?t.context:h,h.data&&h.processData&&"string"!=typeof h.data&&(h.data=function(t){var e,a=[],r=function(t,e){e=_(e)?e():e,a[a.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(I(t))for(e in t)r(e,t[e]);else for(var n in t)A(n,t[n],r);return a.join("&").replace(d,"+")}(h.data)),"jsonp"===h.dataType&&("GET"===v?l.test(h.url)||(h.url+=(u.test(h.url)?"&":"?")+(h.jsonp||"callback")+"=?"):h.data&&l.test(h.data)||(h.data=(h.data?h.data+"&":"")+(h.jsonp||"callback")+"=?"),h.dataType="json"),"json"===h.dataType&&(h.data&&l.test(h.data)||l.test(h.url))){e=h.jsonpCallback||"jsonp"+s++,h.data&&(h.data=(h.data+"").replace(l,"="+e+"$1")),h.url=h.url.replace(l,"="+e+"$1"),h.dataType="script";var g=window[e];window[e]=function(t){if(_(g))g(t);else{window[e]=void 0;try{delete window[e]}catch(t){}}E(h,M,a,r=t),R(h,M,a),j&&j.removeChild(w)}}h.data&&b&&(h.url+=(u.test(h.url)?"&":"?")+h.data);var y=/^(\w+:)?\/\/([^\/?#]+)/.exec(h.url),D=y&&(y[1]&&y[1].toLowerCase()!==location.protocol||y[2].toLowerCase()!==location.host);if("script"===h.dataType&&"GET"===v&&D){var j=document.getElementsByTagName("head")[0]||document.documentElement,w=document.createElement("script");if(h.scriptCharset&&(w.charset=h.scriptCharset),w.src=h.url,!e){var x=!1;w.onload=w.onreadystatechange=function(){x||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(x=!0,E(h,M,a,r),R(h,M,a),w.onload=w.onreadystatechange=null,j&&w.parentNode&&j.removeChild(w))}}j.insertBefore(w,j.firstChild)}else{var C=!1,M=h.xhr();if(M){h.username?M.open(v,h.url,h.async,h.username,h.password):M.open(v,h.url,h.async),h.withCredentials&&"withCredentials"in M&&(M.withCredentials=!0);try{(null!=h.data&&!b||t&&t.contentType)&&M.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(m[h.url]&&M.setRequestHeader("If-Modified-Since",m[h.url]),f[h.url]&&M.setRequestHeader("If-None-Match",f[h.url])),D||M.setRequestHeader("X-Requested-With","XMLHttpRequest"),M.setRequestHeader("Accept",h.dataType&&h.accepts[h.dataType]?h.accepts[h.dataType]+", */*; q=0.01":h.accepts._default)}catch(t){}if(h.beforeSend&&!1===h.beforeSend.call(h.context,M,h))return M.abort(),!1;var S=M.onreadystatechange=function(t){if(M&&0!==M.readyState&&"abort"!==t){if(!C&&M&&(4===M.readyState||"timeout"===t)){var n;if(C=!0,M.onreadystatechange=F,"success"===(a="timeout"===t?"timeout":function(t){try{return!t.status&&"file:"===location.protocol||t.status>=200&&t.status<300||304===t.status||1223===t.status}catch(t){}return!1}(M)?h.ifModified&&function(t,e){var a=t.getResponseHeader("Last-Modified"),r=t.getResponseHeader("Etag");a&&(a[e]=a);r&&(r[e]=r);return 304===t.status}(M,h.url)?"notmodified":"success":"error"))try{r=function(t,e,a){var r=t.getResponseHeader("content-type")||"",n="xml"===e||!e&&r.indexOf("xml")>=0,o=n?t.responseXML:t.responseText;if(n&&"parsererror"===o.documentElement.nodeName)throw"parsererror";a&&a.dataFilter&&(o=a.dataFilter(o,e));"string"==typeof o&&("json"===e||!e&&r.indexOf("json")>=0?o=JSON.parse(o):("script"===e||!e&&r.indexOf("javascript")>=0)&&function(t){if(t&&p.test(t)){var e=document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("script");a.type="text/javascript",scriptEval?a.appendChild(document.createTextNode(t)):a.text=t,e.insertBefore(a,e.firstChild),e.removeChild(a)}}(o));return o}(M,h.dataType,h)}catch(t){a="parsererror",n=t}"success"===a||"notmodified"===a?e||E(h,M,a,r):$(h,M,a,n),e||R(h,M,a),"timeout"===t&&M.abort(),h.async&&(M=null)}}else C||R(h,M,a),C=!0,M&&(M.onreadystatechange=F)};try{var N=M.abort;M.abort=function(){M&&Function.prototype.call.call(N,M),S("abort")}}catch(t){}h.async&&h.timeout>0&&setTimeout(function(){M&&!C&&S("timeout")},h.timeout);try{M.send(b||null==h.data?null:h.data)}catch(t){$(h,M,null,t),R(h,M,a)}return h.async||S(),M}}function T(t){return null==t?String(t):o[toString.call(t)]||"object"}function _(t){return"function"===T(t)}function I(t){return"array"===T(t)}function A(t,e,a){if(I(e)&&e.length)for(var r in e){var n=e[r];i.test(t)?a(t,n):A(t+"["+("object"===(void 0===n?"undefined":c()(n))||I(n)?r:"")+"]",n,a)}else if(null!=e&&"object"===(void 0===e?"undefined":c()(e)))if(function(t){for(var e in t)return!1;return!0}(e))a(t,"");else for(var o in e){A(t+"["+o+"]",n=e[o],a)}else a(t,e)}function $(t,e,a,r){"function"==typeof t.error&&t.error.call(t.context,e,a,r)}function E(t,e,a,r){"function"==typeof t.success&&t.success.call(t.context,r,a,e)}function R(t,e,a){"function"==typeof t.complete&&t.complete.call(t.context,e,a)}function F(){}},v=function(t){var e,a,r=t.data;return"string"==typeof t.dataType&&"string"==typeof t.type&&"json"===(e=t.dataType.toLowerCase())&&"post"===t.type.toLowerCase()&&(r=s()(t.data)),"string"==typeof t.contentType&&(a=t.contentType.toLowerCase()),new n.a(function(n,o){h({url:t.url||"url",type:t.type||"GET",async:!1!==t.async,withCredentials:t.withCredentials,data:r,dataType:e||"default",contentType:a||"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:function(){return"function"!=typeof t.beforeSend||t.beforeSend()},success:function(t,e,a,r){n(t,e,a,r)},error:function(t,e,a,r){o({responseText:t.responseText,code:t.status})},complete:function(t,e,a){n(t,e,a)}})})};e.c=m},xVHK:function(t,e,a){"use strict";var r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"avatar"},[a("ul",{staticClass:"iconImgs avatar-list",class:{"has-more":t.isShowMore}},t._l(t.list,function(e,r){return a("li",{key:"avatar_"+r,staticClass:"iconml"},[a("a",{staticClass:"iconImg",class:{on:t.isSelectedAvatar===e},attrs:{href:"javascript:;"},on:{click:function(a){t.chooseAvatar(e)}}},[a("img",{staticStyle:{width:"50px",height:"50px","border-radius":"50%"},attrs:{src:t.imgUri+e,alt:"头像"}})])])})),t._v(" "),a("div",{staticClass:"more-div"},[a("button",{staticClass:"more-avatar btn",attrs:{type:"button"},on:{click:t.showMore}},[t._v(t._s(t.showMoreText))])])])},staticRenderFns:[]};var n=a("VU/8")({name:"AvatarList",props:["list","selectedAvatar","showMoreState","imgUri"],data:function(){return{isSelectedAvatar:"",showMoreText:"展开",isShowMore:!1}},watch:{selectedAvatar:function(t,e){this.isSelectedAvatar=t},showMoreState:function(t){this.isShowMore=!0===t}},methods:{chooseAvatar:function(t){this.$emit("select",t),this.isSelectedAvatar=t},showMore:function(){this.isShowMore=!this.isShowMore,this.showMoreText=this.isShowMore?"收起":"展开"}}},r,!1,function(t){a("2257")},null,null);e.a=n.exports}},["a4+S"]);