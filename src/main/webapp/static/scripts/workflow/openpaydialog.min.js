webpackJsonp([102],{BD2p:function(t,e,n){"use strict";var i=n("bOdI"),s=n.n(i),r={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return"ivu-icon ivu-icon-"+this.type},styles:function(){var t={};return this.size&&(t["font-size"]=this.size+"px"),this.color&&(t.color=this.color),t}}},a={render:function(){var t=this.$createElement;return(this._self._c||t)("i",{class:this.classes,style:this.styles})},staticRenderFns:[]},o=n("VU/8")(r,a,!1,null,null,null).exports,l=(n("BO1k"),n("7+uW").default.prototype.$isServer);function u(t,e){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}!l&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver);var c={components:{Icon:o},props:{percent:{type:Number,default:0},status:{validator:function(t){return u(t,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1}},data:function(){return{currentStatus:this.status}},computed:{isStatus:function(){return"wrong"==this.currentStatus||"success"==this.currentStatus},statusIcon:function(){var t="";switch(this.currentStatus){case"wrong":t="ios-close";break;case"success":t="ios-checkmark"}return t},bgStyle:function(){return this.vertical?{height:this.percent+"%",width:this.strokeWidth+"px"}:{width:this.percent+"%",height:this.strokeWidth+"px"}},wrapClasses:function(){var t;return["ivu-progress","ivu-progress-"+this.currentStatus,(t={},s()(t,"ivu-progress-show-info",!this.hideInfo),s()(t,"ivu-progress-vertical",this.vertical),t)]},textClasses:function(){return"ivu-progress-text"},textInnerClasses:function(){return"ivu-progress-text-inner"},outerClasses:function(){return"ivu-progress-outer"},innerClasses:function(){return"ivu-progress-inner"},bgClasses:function(){return"ivu-progress-bg"}},created:function(){this.handleStatus()},methods:{handleStatus:function(t){t?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100==parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent:function(t,e){t<e?this.handleStatus(!0):this.handleStatus()},status:function(t){this.currentStatus=t}}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.wrapClasses},[n("div",{class:t.outerClasses},[n("div",{class:t.innerClasses},[n("div",{class:t.bgClasses,style:t.bgStyle})])]),t._v(" "),t.hideInfo?t._e():n("span",{class:t.textClasses},[t._t("default",[t.isStatus?n("span",{class:t.textInnerClasses},[n("Icon",{attrs:{type:t.statusIcon}})],1):n("span",{class:t.textInnerClasses},[t._v("\n                "+t._s(t.percent)+"%\n            ")])])],2)])},staticRenderFns:[]},f={name:"UploadList",components:{Icon:o,iProgress:n("VU/8")(c,p,!1,null,null,null).exports},props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(t){return["ivu-upload-list-file",s()({},"ivu-upload-list-file-finish","finished"===t.status)]},handleClick:function(t){this.$emit("on-file-click",t)},handlePreview:function(t){this.$emit("on-file-preview",t)},handleRemove:function(t){this.$emit("on-file-remove",t)},format:function(t){var e=t.name.split(".").pop().toLocaleLowerCase()||"",n="document";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(e)>-1&&(n="image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(e)>-1&&(n="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(e)>-1&&(n="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(e)>-1&&(n="document-text"),["numbers","csv","xls","xlsx"].indexOf(e)>-1&&(n="stats-bars"),["keynote","ppt","pptx"].indexOf(e)>-1&&(n="ios-videocam"),n},parsePercentage:function(t){return parseInt(t,10)}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{class:[t.prefixCls+"-list"]},t._l(t.files,function(e){return n("li",{class:t.fileCls(e),on:{click:function(n){t.handleClick(e)}}},[n("span",{on:{click:function(n){t.handlePreview(e)}}},[n("Icon",{attrs:{type:t.format(e)}}),t._v(" "+t._s(e.name)+"\n        ")],1),t._v(" "),n("Icon",{directives:[{name:"show",rawName:"v-show",value:"finished"===e.status,expression:"file.status === 'finished'"}],class:[t.prefixCls+"-list-remove"],attrs:{type:"ios-close-empty"},nativeOn:{click:function(n){t.handleRemove(e)}}}),t._v(" "),n("transition",{attrs:{name:"fade"}},[e.showProgress?n("i-progress",{attrs:{"stroke-width":2,percent:t.parsePercentage(e.percentage),status:"finished"===e.status&&e.showProgress?"success":"normal"}}):t._e()],1)],1)}))},staticRenderFns:[]},h=n("VU/8")(f,d,!1,null,null,null).exports,m=n("fZjL"),v=n.n(m);function g(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function x(t){if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest,n=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var i=new FormData;t.data&&v()(t.data).map(function(e){i.append(e,t.data[e])}),i.append(t.filename,t.file),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,n){var i="fail to post "+t+" "+n.status+"'",s=new Error(i);return s.status=n.status,s.method="post",s.url=t,s}(n,0,e),g(e));t.onSuccess(g(e))},e.open("post",n,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var s=t.headers||{};for(var r in s)s.hasOwnProperty(r)&&null!==s[r]&&e.setRequestHeader(r,s[r]);e.send(i)}}var y={name:"Upload",mixins:[{methods:{dispatch:function(t,e,n){for(var i=this.$parent||this.$root,s=i.$options.name;i&&(!s||s!==t);)(i=i.$parent)&&(s=i.$options.name);i&&i.$emit.apply(i,[e].concat(n))},broadcast:function(t,e,n){(function t(e,n,i){this.$children.forEach(function(s){s.$options.name===e?s.$emit.apply(s,[n].concat(i)):t.apply(s,[e,n].concat([i]))})}).call(this,t,e,n)}}}],components:{UploadList:h},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(t){return u(t,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},maxSelectNum:{type:Number},existNum:{type:Number},index:{type:Number}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var t;return["ivu-upload",(t={},s()(t,"ivu-upload-select","select"===this.type),s()(t,"ivu-upload-drag","drag"===this.type),s()(t,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),t)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(t){var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},onDrop:function(t){this.dragOver=!1,this.uploadFiles(t.dataTransfer.files)},uploadFiles:function(t){var e=this,n=Array.prototype.slice.call(t);if(this.maxSelectNum&&n.length>this.maxSelectNum-this.existNum)return erpShopApp.tip("最多只能上传"+this.maxSelectNum+"张图片！","info"),!1;this.multiple||(n=n.slice(0,1)),0!==n.length&&n.forEach(function(t){e.upload(t)})},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);var n=this.beforeUpload(t,this.index);n&&n.then?n.then(function(n){"[object File]"===Object.prototype.toString.call(n)?e.post(n):e.post(t)},function(){}):!1!==n&&this.post(t)},post:function(t){var e=this;if(this.format.length){var n=t.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(t){return t.toLocaleLowerCase()===n}))return this.onFormatError(t,this.fileList),!1}if(this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),(new FormData).append(this.name,t),x({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(n){e.handleProgress(n,t)},onSuccess:function(n){e.handleSuccess(n,t,e.index)},onError:function(n,i){e.handleError(n,i,t)}})},handleStart:function(t){t.uid=Date.now()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e)},getFile:function(t){var e=void 0;return this.fileList.every(function(n){return!(e=t.uid===n.uid?n:null)}),e},handleProgress:function(t,e){var n=this.getFile(e);this.onProgress(t,n,this.fileList),n.percentage=t.percent||0},handleSuccess:function(t,e,n){var i=this.getFile(e);i&&(i.status="finished",i.response=t,this.dispatch("FormItem","on-form-change",i),this.onSuccess(t,i,this.fileList,n),setTimeout(function(){i.showProgress=!1},1e3))},handleError:function(t,e,n){var i=this.getFile(n),s=this.fileList;i.status="fail",s.splice(s.indexOf(i),1),this.onError(t,e,n)},handleRemove:function(t){var e=this.fileList;e.splice(e.indexOf(t),1),this.onRemove(t,e)},handlePreview:function(t){"finished"===t.status&&this.onPreview(t)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(t){var e=this;this.fileList=t.map(function(t){return t.status="finished",t.percentage=100,t.uid=Date.now()+e.tempIndex++,t})}}}},w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:[t.prefixCls]},[n("div",{class:t.classes,on:{click:t.handleClick,drop:function(e){e.preventDefault(),t.onDrop(e)},dragover:function(e){e.preventDefault(),t.dragOver=!0},dragleave:function(e){e.preventDefault(),t.dragOver=!1}}},[n("input",{ref:"input",class:[t.prefixCls+"-input"],attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}}),t._v(" "),t._t("default")],2),t._v(" "),t._t("tip"),t._v(" "),t.showUploadList?n("upload-list",{attrs:{files:t.fileList},on:{"on-file-remove":t.handleRemove,"on-file-preview":t.handlePreview}}):t._e()],2)},staticRenderFns:[]},S=n("VU/8")(y,w,!1,null,null,null);e.a=S.exports},q2UF:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Dd8w"),s=n.n(i),r=n("7+uW"),a=(n("mtWM"),{data:function(){return{formData:{imgarr:[]},type:erpApp.getQueryString("type"),taskId:erpApp.getQueryString("taskId"),procInsId:erpApp.getQueryString("procInsId"),staticText:{boxtitle:["确定商户不进行支付宝口碑开通","上传商户确认不进行口碑支付宝的聊天截图","上传商户确认不进行银联支付的聊天截图"]},uploadAction:ctx+"/workfile/file/uploads",uploadUrl:pageDataObject.uploadfileurl}},computed:{formDatas:function(){var t=[];return this.formData.imgarr.forEach(function(e,n){n<5&&t.push(e.id)}),t.join(",")},boxtitle:function(){return"alipay"===this.type?this.staticText.boxtitle[1]:this.staticText.boxtitle[2]},datas:function(){return{taskId:this.taskId,procInsId:this.procInsId,fileId:"",fileUrl:""}}},components:{upload:n("BD2p").a},mounted:function(){},methods:{handleSuccess:function(t,e){if(this.formData.imgarr.length>=5)return this.formData.imgarr.splice(5,1e4),erpApp.tip("最多只能上传5张图片！"),!1;"SUCCESS"===t.state?this.formData.imgarr.push({id:t.orderFileId,file_name:t.fileName,file_path:t.fileUrl}):erpApp.tip("文件 "+e.name+"上传失败！","error");var n=this.$refs.uploadImg.fileList;this.$refs.uploadImg.fileList.splice(n.indexOf(e),1)},handleFormatError:function(t){erpApp.tip("文件 "+t.name+" 格式不正确，请上传 jpg 或 png 格式的图片。","error")},handleMaxSize:function(t){erpApp.tip("文件 "+t.name+" 太大，不能超过 20M。","error")},removeFile:function(t){var e=this;erpApp.confirm("确定要删除该截图吗？",function(){e.formData.imgarr.splice(t,1),erpApp.tip("删除成功！")})},beforeupload:function(t){if(this.formData.imgarr.length>=5)return this.formData.imgarr.splice(5,1e4),erpApp.tip("最多只能上传5张图片！"),!1}}}),o={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"store"},[n("div",{staticClass:"undisableOpenBox"},[n("div",{staticClass:"content",staticStyle:{"margin-left":"20px"}},[n("div",{staticClass:"content-title",staticStyle:{height:"40px","line-height":"40px"}},[t._v(t._s(t.boxtitle))]),t._v(" "),n("div",{staticClass:"uploadwrap"},[n("div",{staticClass:"upload-img"},[n("upload",{ref:"uploadImg",staticStyle:{display:"inline-block",width:"76px"},attrs:{type:"drag","on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,"before-upload":t.beforeupload,format:["jpg","jpeg","png","gif"],accept:"image/*",multiple:"","max-size":20480,action:t.uploadAction,data:t.datas}},[n("div",{staticStyle:{width:"76px",height:"30px","line-height":"30px","text-align":"center"}},[n("span",[n("i",{staticClass:"icon-camera"}),t._v("上传")])])])],1),t._v(" "),t.formData.imgarr.length>0?n("div",{staticClass:"imgs"},[t._l(t.formData.imgarr,function(e,i){return[i<5?n("div",{staticClass:"img-list"},[n("div",[e.file_path?n("img",{attrs:{src:t.uploadUrl+e.file_path,alt:"图片"}}):t._e()]),t._v(" "),n("button",{staticClass:"ios-trash-outline",on:{click:function(e){t.removeFile(i)}}},[t._v("删除")])]):t._e()]})],2):t._e()])])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formDatas,expression:"formDatas",modifiers:{trim:!0}}],staticClass:"hide",attrs:{type:"hidden",id:"formDataInput"},domProps:{value:t.formDatas},on:{input:function(e){e.target.composing||(t.formDatas=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])},staticRenderFns:[]},l=n("VU/8")(a,o,!1,null,null,null).exports;r.default.config.productionTip=!1,r.default.config.devtools=!1,new r.default(s()({},l)).$mount("#rootNode")}},["q2UF"]);