webpackJsonp([99],{BD2p:function(t,e,i){"use strict";var o=i("bOdI"),n=i.n(o),s={name:"Icon",props:{type:String,size:[Number,String],color:String},computed:{classes:function(){return"ivu-icon ivu-icon-"+this.type},styles:function(){var t={};return this.size&&(t["font-size"]=this.size+"px"),this.color&&(t.color=this.color),t}}},a={render:function(){var t=this.$createElement;return(this._self._c||t)("i",{class:this.classes,style:this.styles})},staticRenderFns:[]},r=i("VU/8")(s,a,!1,null,null,null).exports,l=(i("BO1k"),i("7+uW").default.prototype.$isServer);function p(t,e){for(var i=0;i<e.length;i++)if(t===e[i])return!0;return!1}!l&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver);var u={components:{Icon:r},props:{percent:{type:Number,default:0},status:{validator:function(t){return p(t,["normal","active","wrong","success"])},default:"normal"},hideInfo:{type:Boolean,default:!1},strokeWidth:{type:Number,default:10},vertical:{type:Boolean,default:!1}},data:function(){return{currentStatus:this.status}},computed:{isStatus:function(){return"wrong"==this.currentStatus||"success"==this.currentStatus},statusIcon:function(){var t="";switch(this.currentStatus){case"wrong":t="ios-close";break;case"success":t="ios-checkmark"}return t},bgStyle:function(){return this.vertical?{height:this.percent+"%",width:this.strokeWidth+"px"}:{width:this.percent+"%",height:this.strokeWidth+"px"}},wrapClasses:function(){var t;return["ivu-progress","ivu-progress-"+this.currentStatus,(t={},n()(t,"ivu-progress-show-info",!this.hideInfo),n()(t,"ivu-progress-vertical",this.vertical),t)]},textClasses:function(){return"ivu-progress-text"},textInnerClasses:function(){return"ivu-progress-text-inner"},outerClasses:function(){return"ivu-progress-outer"},innerClasses:function(){return"ivu-progress-inner"},bgClasses:function(){return"ivu-progress-bg"}},created:function(){this.handleStatus()},methods:{handleStatus:function(t){t?(this.currentStatus="normal",this.$emit("on-status-change","normal")):100==parseInt(this.percent,10)&&(this.currentStatus="success",this.$emit("on-status-change","success"))}},watch:{percent:function(t,e){t<e?this.handleStatus(!0):this.handleStatus()},status:function(t){this.currentStatus=t}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.wrapClasses},[i("div",{class:t.outerClasses},[i("div",{class:t.innerClasses},[i("div",{class:t.bgClasses,style:t.bgStyle})])]),t._v(" "),t.hideInfo?t._e():i("span",{class:t.textClasses},[t._t("default",[t.isStatus?i("span",{class:t.textInnerClasses},[i("Icon",{attrs:{type:t.statusIcon}})],1):i("span",{class:t.textInnerClasses},[t._v("\n                "+t._s(t.percent)+"%\n            ")])])],2)])},staticRenderFns:[]},d={name:"UploadList",components:{Icon:r,iProgress:i("VU/8")(u,c,!1,null,null,null).exports},props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(t){return["ivu-upload-list-file",n()({},"ivu-upload-list-file-finish","finished"===t.status)]},handleClick:function(t){this.$emit("on-file-click",t)},handlePreview:function(t){this.$emit("on-file-preview",t)},handleRemove:function(t){this.$emit("on-file-remove",t)},format:function(t){var e=t.name.split(".").pop().toLocaleLowerCase()||"",i="document";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(e)>-1&&(i="image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(e)>-1&&(i="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(e)>-1&&(i="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(e)>-1&&(i="document-text"),["numbers","csv","xls","xlsx"].indexOf(e)>-1&&(i="stats-bars"),["keynote","ppt","pptx"].indexOf(e)>-1&&(i="ios-videocam"),i},parsePercentage:function(t){return parseInt(t,10)}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{class:[t.prefixCls+"-list"]},t._l(t.files,function(e){return i("li",{class:t.fileCls(e),on:{click:function(i){t.handleClick(e)}}},[i("span",{on:{click:function(i){t.handlePreview(e)}}},[i("Icon",{attrs:{type:t.format(e)}}),t._v(" "+t._s(e.name)+"\n        ")],1),t._v(" "),i("Icon",{directives:[{name:"show",rawName:"v-show",value:"finished"===e.status,expression:"file.status === 'finished'"}],class:[t.prefixCls+"-list-remove"],attrs:{type:"ios-close-empty"},nativeOn:{click:function(i){t.handleRemove(e)}}}),t._v(" "),i("transition",{attrs:{name:"fade"}},[e.showProgress?i("i-progress",{attrs:{"stroke-width":2,percent:t.parsePercentage(e.percentage),status:"finished"===e.status&&e.showProgress?"success":"normal"}}):t._e()],1)],1)}))},staticRenderFns:[]},f=i("VU/8")(d,h,!1,null,null,null).exports,m=i("fZjL"),v=i.n(m);function g(t){var e=t.responseText||t.response;if(!e)return e;try{return JSON.parse(e)}catch(t){return e}}function y(t){if("undefined"!=typeof XMLHttpRequest){var e=new XMLHttpRequest,i=t.action;e.upload&&(e.upload.onprogress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),t.onProgress(e)});var o=new FormData;t.data&&v()(t.data).map(function(e){o.append(e,t.data[e])}),o.append(t.filename,t.file),e.onerror=function(e){t.onError(e)},e.onload=function(){if(e.status<200||e.status>=300)return t.onError(function(t,e,i){var o="fail to post "+t+" "+i.status+"'",n=new Error(o);return n.status=i.status,n.method="post",n.url=t,n}(i,0,e),g(e));t.onSuccess(g(e))},e.open("post",i,!0),t.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);var n=t.headers||{};for(var s in n)n.hasOwnProperty(s)&&null!==n[s]&&e.setRequestHeader(s,n[s]);e.send(o)}}var x={name:"Upload",mixins:[{methods:{dispatch:function(t,e,i){for(var o=this.$parent||this.$root,n=o.$options.name;o&&(!n||n!==t);)(o=o.$parent)&&(n=o.$options.name);o&&o.$emit.apply(o,[e].concat(i))},broadcast:function(t,e,i){(function t(e,i,o){this.$children.forEach(function(n){n.$options.name===e?n.$emit.apply(n,[i].concat(o)):t.apply(n,[e,i].concat([o]))})}).call(this,t,e,i)}}}],components:{UploadList:f},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(t){return p(t,["select","drag"])},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}},maxSelectNum:{type:Number},existNum:{type:Number},index:{type:Number}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var t;return["ivu-upload",(t={},n()(t,"ivu-upload-select","select"===this.type),n()(t,"ivu-upload-drag","drag"===this.type),n()(t,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),t)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(t){var e=t.target.files;e&&(this.uploadFiles(e),this.$refs.input.value=null)},onDrop:function(t){this.dragOver=!1,this.uploadFiles(t.dataTransfer.files)},uploadFiles:function(t){var e=this,i=Array.prototype.slice.call(t);if(this.maxSelectNum&&i.length>this.maxSelectNum-this.existNum)return erpShopApp.tip("最多只能上传"+this.maxSelectNum+"张图片！","info"),!1;this.multiple||(i=i.slice(0,1)),0!==i.length&&i.forEach(function(t){e.upload(t)})},upload:function(t){var e=this;if(!this.beforeUpload)return this.post(t);var i=this.beforeUpload(t,this.index);i&&i.then?i.then(function(i){"[object File]"===Object.prototype.toString.call(i)?e.post(i):e.post(t)},function(){}):!1!==i&&this.post(t)},post:function(t){var e=this;if(this.format.length){var i=t.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(t){return t.toLocaleLowerCase()===i}))return this.onFormatError(t,this.fileList),!1}if(this.maxSize&&t.size>1024*this.maxSize)return this.onExceededSize(t,this.fileList),!1;this.handleStart(t),(new FormData).append(this.name,t),y({headers:this.headers,withCredentials:this.withCredentials,file:t,data:this.data,filename:this.name,action:this.action,onProgress:function(i){e.handleProgress(i,t)},onSuccess:function(i){e.handleSuccess(i,t,e.index)},onError:function(i,o){e.handleError(i,o,t)}})},handleStart:function(t){t.uid=Date.now()+this.tempIndex++;var e={status:"uploading",name:t.name,size:t.size,percentage:0,uid:t.uid,showProgress:!0};this.fileList.push(e)},getFile:function(t){var e=void 0;return this.fileList.every(function(i){return!(e=t.uid===i.uid?i:null)}),e},handleProgress:function(t,e){var i=this.getFile(e);this.onProgress(t,i,this.fileList),i.percentage=t.percent||0},handleSuccess:function(t,e,i){var o=this.getFile(e);o&&(o.status="finished",o.response=t,this.dispatch("FormItem","on-form-change",o),this.onSuccess(t,o,this.fileList,i),setTimeout(function(){o.showProgress=!1},1e3))},handleError:function(t,e,i){var o=this.getFile(i),n=this.fileList;o.status="fail",n.splice(n.indexOf(o),1),this.onError(t,e,i)},handleRemove:function(t){var e=this.fileList;e.splice(e.indexOf(t),1),this.onRemove(t,e)},handlePreview:function(t){"finished"===t.status&&this.onPreview(t)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(t){var e=this;this.fileList=t.map(function(t){return t.status="finished",t.percentage=100,t.uid=Date.now()+e.tempIndex++,t})}}}},S={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:[t.prefixCls]},[i("div",{class:t.classes,on:{click:t.handleClick,drop:function(e){e.preventDefault(),t.onDrop(e)},dragover:function(e){e.preventDefault(),t.dragOver=!0},dragleave:function(e){e.preventDefault(),t.dragOver=!1}}},[i("input",{ref:"input",class:[t.prefixCls+"-input"],attrs:{type:"file",multiple:t.multiple,accept:t.accept},on:{change:t.handleChange}}),t._v(" "),t._t("default")],2),t._v(" "),t._t("tip"),t._v(" "),t.showUploadList?i("upload-list",{attrs:{files:t.fileList},on:{"on-file-remove":t.handleRemove,"on-file-preview":t.handlePreview}}):t._e()],2)},staticRenderFns:[]},C=i("VU/8")(x,S,!1,null,null,null);e.a=C.exports},H0Ff:function(t,e,i){"use strict";var o,n=i("bOdI"),s=i.n(n),a=ctx+"/store/basic/erpStoreInfo";e.a=(o={uploadUrl:"oc.yunnex.com"===location.hostname?"http://oc.yunnex.com/":"http://erp.zb25.com.cn/",uploadfiles:a+"/file/erpFileInfo/uploadFile",urlErpShopInfoList:a+"/urlErpShopInfoList",shoprolelist:a+"/shoprolelist",getlist:a+"/getlist",getSynthesizeList:a+"/getSynthesizeList",getShopInfo:a+"/getShopInfo",newStorelist:a+"/newStorelist",queryMainStoreInfo:a+"/queryMainStoreInfo",addlinkman:a+"/addlinkman",updatelinkman:a+"/updatelinkman",deletelinkman:a+"/deletelinkman",basicinformationlist:a+"/basicinformationlist",upload:ctx+"/file/erpFileInfo/uploadFile",addbasicinformation:a+"/addbasicinformation",wxpaylist:a+"/wxpaylist",addwxpay:a+"/addwxpay",addNewStore:a+"/addNewStore",unionpaylist:a+"/unionpaylist",addunionpaypay:a+"/addunionpaypay",friendslist:a+"/friendslist",addfriends:a+"/addfriends",weibolist:a+"/weibolist",addweibo:a+"/addweibo",momolist:a+"/momolist",addmomo:a+"/addmomo",photolist:a+"/photolist",addphoto:a+"/addphoto"},s()(o,"momolist",a+"/momolist"),s()(o,"zhangbeilist",a+"/zhangbeilist"),s()(o,"mainstore",a+"/mainstore"),s()(o,"zhangbeiaudit",a+"/zhangbeiaudit"),s()(o,"wxpayOpen",a+"/wxpayOpen"),s()(o,"wxpayaudit",a+"/wxpayaudit"),s()(o,"unionOpen",a+"/unionOpen"),s()(o,"unionaudit",a+"/unionaudit"),s()(o,"friendCheckList",a+"/friendCheckList"),s()(o,"friendCheck",a+"/friendCheck"),s()(o,"weiboCheckList",a+"/weiboCheckList"),s()(o,"momoCheckList",a+"/momoCheckList"),s()(o,"momoCheck",a+"/momoCheck"),s()(o,"weiboCheck",a+"/weiboCheck"),s()(o,"bankCopy",a+"/bankCopy"),s()(o,"findZhangbeiIntopieceInfo",a+"/findZhangbeiIntopieceInfo"),s()(o,"findWxIntopieceInfo",a+"/findWxIntopieceInfo"),s()(o,"findUnionIntopieceInfo",a+"/findUnionIntopieceInfo"),o)},Mpkn:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("Dd8w"),n=i.n(o),s=i("7+uW"),a=i("mtWM"),r=i.n(a),l=i("H0Ff"),p={data:function(){return{info:{shopid:erpShopApp.getQueryString("datas",location.href).split(",")[0],shopname:"",storeid:erpShopApp.getQueryString("datas",location.href).split(",")[1],photo:{id:"",isNewRecord:!1,createDate:"",updateDate:"",auditStatus:0,environmentPhoto:"",productPhoto:"",environmentPhotoCount:0,productPhotoCount:0,menuPhoto:"",menuPhotoCount:0,storeInfoId:""}},shopId:erpShopApp.getQueryString("datas",location.href).split(",")[0],storeId:erpShopApp.getQueryString("datas",location.href).split(",")[1],ctx:ctx,uploadAction:l.a.upload,uploadUrl:pageDataObject.uploadfileurl||l.a.uploadUrl,shopstorePage:pageDataObject,editTimer:0,isEditting:!1}},computed:{photolist:function(){return this.info}},components:{upload:i("BD2p").a},mounted:function(){this.getPhotolist()},updated:function(){this.photolist.photo.environmentPhotoCount=this.getCount(this.photolist.photo.environmentPhoto.split(";")),this.photolist.photo.productPhotoCount=this.getCount(this.photolist.photo.productPhoto.split(";")),this.photolist.photo.menuPhotoCount=this.getCount(this.photolist.photo.menuPhoto.split(";"))},methods:{getPhotolist:function(){var t=this;r.a.get(l.a.photolist,{params:{shopid:this.shopId,storeid:this.storeId}}).then(function(e){t.info=erpShopApp.extend(!0,t.info,e.data)})},getCount:function(t){for(var e=t.length,i=0;e--;)t[e]&&i++;return i},deletePhoto:function(t,e){var i=this;erpShopApp.confirm("确定要删除图片吗？",function(){var o=i.photolist.photo[t].split(";");o.splice(e,1),i.photolist.photo[t]=o.join(";"),erpShopApp.closedTip()})},handleSuccess:function(t,e){t.success?this.info.photo.menuPhoto+=t.entry.successUrls[0]+";":erpShopApp.tip("文件 "+e.name+"上传失败！","error");var i=this.$refs.menuPhoto.fileList;this.$refs.menuPhoto.fileList.splice(i.indexOf(e),1)},handleSuccessEnvironmentPhoto:function(t,e){t.success?this.info.photo.environmentPhoto+=t.entry.successUrls[0]+";":erpShopApp.tip("文件 "+e.name+"上传失败！","error");var i=this.$refs.environmentPhoto.fileList;this.$refs.environmentPhoto.fileList.splice(i.indexOf(e),1)},handleSuccessProductPhoto:function(t,e){t.success?this.info.photo.productPhoto+=t.entry.successUrls[0]+";":erpShopApp.tip("文件 "+e.name+"上传失败！","error");var i=this.$refs.productPhoto.fileList;this.$refs.productPhoto.fileList.splice(i.indexOf(e),1)},handleFormatError:function(t){erpShopApp.tip("文件 "+t.name+" 格式不正确，请上传 jpg 或 png 格式的图片。","error")},handleMaxSize:function(t){erpShopApp.tip("文件 "+t.name+" 太大，不能超过 20M。","error")}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"store"},[i("div",{staticClass:"padding10 shopbaseinfo-wrapper"},[i("div",{staticClass:"clearboth margin-bottom-10 storebaseinfo-wrapper"},[i("div",{staticClass:"form-horizontal clearboth erpstore-horizontal"},[i("div",{staticClass:"control-group"},[i("label",{staticClass:"control-label"},[t._v("门店环境图：")]),t._v(" "),i("div",{staticClass:"controls"},[0===t.photolist.photo.auditStatus||3===t.photolist.photo.auditStatus?i("div",{staticClass:"uploadWrappers"},[i("upload",{ref:"environmentPhoto",staticStyle:{display:"inline-block",width:"76px"},attrs:{type:"drag","on-success":t.handleSuccessEnvironmentPhoto,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,format:["jpg","jpeg","png","gif"],accept:"image/*",multiple:"","max-size":20480,action:t.uploadAction}},[i("div",{staticStyle:{width:"76px",height:"30px","line-height":"30px","text-align":"center"}},[i("span",[i("i",{staticClass:"icon-camera"}),t._v("选择图片")])])])],1):t._e(),t._v(" "),i("div",{staticClass:"environmentPhoto imgs"},[t.photolist.photo.environmentPhoto?i("ul",{staticClass:"photos"},t._l(t.photolist.photo.environmentPhoto.split(";"),function(e,o){return e?i("li",{key:"p_"+o,staticClass:"photoitem"},[i("div",{staticClass:"imgbox"},[i("img",{attrs:{src:t.uploadUrl+e,alt:"门店环境图"}}),t._v(" "),i("div",{staticClass:"deletebtn"},[i("button",{staticClass:"btn btn-warning",on:{click:function(e){t.deletePhoto("environmentPhoto",o)}}},[t._v("删除")])])])]):t._e()})):t._e()])])]),t._v(" "),i("div",{staticClass:"control-group"},[i("label",{staticClass:"control-label"},[t._v("产品图：")]),t._v(" "),i("div",{staticClass:"controls"},[0===t.photolist.photo.auditStatus||3===t.photolist.photo.auditStatus?i("div",{staticClass:"uploadWrappers"},[i("upload",{ref:"productPhoto",staticStyle:{display:"inline-block",width:"76px"},attrs:{type:"drag","on-success":t.handleSuccessProductPhoto,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,format:["jpg","jpeg","png","gif"],accept:"image/*",multiple:"","max-size":20480,action:t.uploadAction}},[i("div",{staticStyle:{width:"76px",height:"30px","line-height":"30px","text-align":"center"}},[i("span",[i("i",{staticClass:"icon-camera"}),t._v("选择图片")])])])],1):t._e(),t._v(" "),i("div",{staticClass:"productPhoto imgs"},[t.photolist.photo.productPhoto?i("ul",{staticClass:"photos"},t._l(t.photolist.photo.productPhoto.split(";"),function(e,o){return e?i("li",{key:"pp_"+o,staticClass:"photoitem"},[i("div",{staticClass:"imgbox"},[i("img",{attrs:{src:t.uploadUrl+e,alt:"产品图"}}),t._v(" "),i("div",{staticClass:"deletebtn"},[i("button",{staticClass:"btn btn-warning",on:{click:function(e){t.deletePhoto("productPhoto",o)}}},[t._v("删除")])])])]):t._e()})):t._e()])])]),t._v(" "),i("div",{staticClass:"control-group"},[i("label",{staticClass:"control-label"},[t._v("菜单/服务类目表：")]),t._v(" "),i("div",{staticClass:"controls"},[0===t.photolist.photo.auditStatus||3===t.photolist.photo.auditStatus?i("div",{staticClass:"uploadWrappers"},[i("upload",{ref:"menuPhoto",staticStyle:{display:"inline-block",width:"76px"},attrs:{type:"drag","on-success":t.handleSuccess,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,format:["jpg","jpeg","png","gif"],accept:"image/*",multiple:"","max-size":20480,action:t.uploadAction}},[i("div",{staticStyle:{width:"76px",height:"30px","line-height":"30px","text-align":"center"}},[i("span",[i("i",{staticClass:"icon-camera"}),t._v("选择图片")])])])],1):t._e(),t._v(" "),i("div",{staticClass:"productPhoto imgs"},[t.photolist.photo.menuPhoto?i("ul",{staticClass:"photos"},t._l(t.photolist.photo.menuPhoto.split(";"),function(e,o){return e?i("li",{key:"pm_"+o,staticClass:"photoitem"},[i("div",{staticClass:"imgbox"},[i("img",{attrs:{src:t.uploadUrl+e,alt:"产品图"}}),t._v(" "),i("div",{staticClass:"deletebtn"},[i("button",{staticClass:"btn btn-warning",on:{click:function(e){t.deletePhoto("menuPhoto",o)}}},[t._v("删除")])])])]):t._e()})):t._e()])])])])]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:JSON.stringify(t.photolist),expression:"JSON.stringify(photolist)"}],attrs:{type:"hidden",id:"formDataInput"},domProps:{value:JSON.stringify(t.photolist)},on:{input:function(e){e.target.composing||t.$set(JSON,"stringify(photolist)",e.target.value)}}})])])},staticRenderFns:[]},c=i("VU/8")(p,u,!1,null,null,null).exports;s.default.config.productionTip=!1,s.default.config.devtools=!1,new s.default(n()({},c)).$mount("#promotionWrapper")}},["Mpkn"]);