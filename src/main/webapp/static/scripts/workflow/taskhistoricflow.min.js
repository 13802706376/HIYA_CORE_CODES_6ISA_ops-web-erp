webpackJsonp([129],{"7W8s":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("7+uW"),a=i("mtWM"),n=i.n(a);Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[i]:("00"+e[i]).substr((""+e[i]).length)));return t};var r={name:"taskhistoricflow",data:function(){return{data:{},uploadUrl:"",flow:window.__flow,remarks:[],ctx:ctx,ctxStatic:ctxStatic,taskId:getQueryString("taskId",location.href)||getQueryString("procInsId",location.href),isMore:!1}},computed:{taskhistory:function(){return this.data.taskHistory&&this.data.taskHistory instanceof Array?this.data.taskHistory:[]},inputDetailList:function(){return this.data.inputDetailList&&this.data.inputDetailList instanceof Array?this.data.inputDetailList:[]},orderFileList:function(){return this.data.orderFileList&&this.data.orderFileList instanceof Array?this.data.orderFileList:[]}},created:function(){this.uploadUrl=window.__configuploadurl__,this.getData(window.__taskHistoicFlowTaskUrl__)},methods:{getFormatDate:function(t,e){return void 0==t&&(t=new Date),void 0==e&&(e="yyyy-MM-dd hh:mm:ss"),t.format(e)},getData:function(t){var e=this;n.a.get(t).then(function(t){e.data=JSON.parse(t.data.result)}).catch(function(t){})},getRemark:function(){var t=this,e={taskId:this.taskId,flowType:this.flow};n.a.get(ctx+"/remarks/workflowRemarksInfo/findRemarksInfosByTaskId",{params:e}).then(function(e){"0"===e.data.code&&(t.remarks=e.data.attach||[])})},addRemarks:function(){addWorkflowRemarks(this.taskId,this.flow,this.getRemark)},deleteRemarks:function(t,e,i){var s=this;if(e===pageDataObject.userid){confirmNew("确定要删除该备注吗？",function(){n.a.get(ctx+"/remarks/workflowRemarksInfo/delete",{params:{id:t}}).then(function(t){"0"===t.data.code?(tipNew("删除备注成功！"),s.remarks.splice(i,1)):tipNew(t.data.message||"删除备注失败！")}).catch(function(t){tipNew("删除备注失败，请稍后重试！")})})}else tipNew("您不是该备注的创建人，不能删除！","info")},toggleMoreRemark:function(){this.isMore=!this.isMore},subext:function(t){return t?t.substring(t.lastIndexOf(".")+1,t.length).toLocaleLowerCase():"xxxxxxx"},makeClass:function(t,e){return t?1==+e?"icon-state-lsm icon-ok":0==+e?"icon-state-lsm icon-screenshot":"icon-state-lsm icon-off":1==+e?"timeline-wrap-title wancheng border-bottom-gray":0==+e?"timeline-wrap-title chulizh border-bottom-gray":"timeline-wrap-title liuzh border-bottom-gray"}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"aps"},[i("div",{staticClass:"act-process-timeline"},[i("div",{staticClass:"act-process-timeline-left floatleft padding-lr-20"},[t._m(0),t._v(" "),t._l(t.taskhistory,function(e,s){return 0!==t.taskhistory.length?i("div",{key:e.taskTime,staticClass:"act-process-timeline-item border-left-gray"},[i("div",{staticClass:"timeline-wrap positionrelative"},[i("div",{class:t.makeClass(!1,e.isFinished)},[i("div",{staticClass:"twt-title inline-block"},[t._v(t._s(e.taskName))]),t._v(" "),i("div",{staticClass:"twt-name inline-block"},[t._v(t._s(e.taskPerson))]),t._v(" "),i("div",{staticClass:"twt-name inline-block"},[t._v(t._s(e.taskTime?t.getFormatDate(new Date(e.taskTime)):""))])]),t._v(" "),t._l(e.subTaskHistroy,function(s,a){return e.subTaskHistroy?i("div",{key:s.taskTime,staticClass:"timeline-wrap-content actc-list"},[i("div",{staticClass:"floatleft actc"},[i("i",{class:t.makeClass(!0,s.isFinished)}),t._v(" "),i("span",{attrs:{title:s.taskName}},[t._v(t._s(s.taskName))])]),t._v(" "),i("div",{staticClass:"twcontent-time"},[t._v(t._s(t.getFormatDate(new Date(s.taskTime))))])]):t._e()})],2)]):t._e()})],2)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"act-process-timeline-title border-bottom-gray"},[e("div",{staticClass:"ptt-name inline-block"},[this._v("任务内容")]),this._v(" "),e("div",{staticClass:"ptt-name inline-block"},[this._v("负责人")]),this._v(" "),e("div",{staticClass:"ptt-name inline-block"},[this._v("时间")])])}]},l=i("VU/8")(r,o,!1,null,null,null).exports;s.default.config.productionTip=!1,s.default.config.devtools=!1,new s.default({el:"#taskHistoricFlowPage",render:function(t){return t(l)}})}},["7W8s"]);